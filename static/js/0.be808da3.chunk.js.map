{"version":3,"sources":["../node_modules/eth-block-tracker/src/base.js","../node_modules/@babel/runtime/helpers/superPropBase.js","../node_modules/json-rpc-random-id/index.js","../node_modules/safe-event-emitter/index.js","../../src/idRemapMiddleware.ts","../../src/createAsyncMiddleware.ts","../../src/createScaffoldMiddleware.ts","../../src/index.ts","../../src/errors.ts","../../src/mergeMiddleware.ts","../node_modules/eth-json-rpc-filters/node_modules/eth-json-rpc-middleware/node_modules/json-rpc-engine/src/createScaffoldMiddleware.js","../node_modules/eth-json-rpc-filters/log-filter.js","../node_modules/eth-json-rpc-filters/node_modules/pify/index.js","../node_modules/eth-json-rpc-filters/base-filter-history.js","../node_modules/eth-json-rpc-filters/block-filter.js","../node_modules/eth-json-rpc-filters/tx-filter.js","../node_modules/async-mutex/es6/Semaphore.js","../node_modules/async-mutex/es6/Mutex.js","../node_modules/async-mutex/es6/withTimeout.js","../node_modules/@babel/runtime/helpers/toConsumableArray.js","../node_modules/eth-json-rpc-filters/hexUtils.js","../node_modules/xtend/immutable.js","../index.ts","../../src/classes.ts","../../src/error-constants.ts","../node_modules/eth-json-rpc-filters/base-filter.js","../node_modules/eth-json-rpc-filters/getBlocksForRange.js","../node_modules/eth-block-tracker/src/polling.js","../node_modules/pify/index.js","../node_modules/@babel/runtime/helpers/get.js","../node_modules/eth-query/index.js","../node_modules/eth-json-rpc-filters/index.js","../../src/getUniqueId.ts","../../src/JsonRpcEngine.ts","../node_modules/fast-safe-stringify/index.js","../../src/utils.ts","../node_modules/eth-json-rpc-filters/node_modules/eth-json-rpc-middleware/scaffold.js","../node_modules/eth-json-rpc-filters/subscriptionManager.js","../node_modules/@babel/runtime/helpers/arrayWithoutHoles.js","../node_modules/@babel/runtime/helpers/iterableToArray.js","../node_modules/@babel/runtime/helpers/nonIterableSpread.js"],"names":["SafeEventEmitter","require","sec","calculateSum","accumulator","currentValue","blockTrackerEvents","BaseBlockTracker","opts","_blockResetDuration","blockResetDuration","_blockResetTimeout","_currentBlock","_isRunning","_onNewListener","bind","_onRemoveListener","_resetCurrentBlock","_setupInternalEvents","this","Promise","resolve","once","latestBlock","eventName","removeListener","on","handler","includes","_maybeStart","_getBlockTrackerEventCount","_maybeEnd","_cancelBlockResetTimeout","_start","_setupBlockResetTimeout","_end","map","listenerCount","reduce","newBlock","currentBlock","hexToInt","_setCurrentBlock","oldBlock","emit","setTimeout","unref","clearTimeout","hexInt","Number","parseInt","module","exports","getPrototypeOf","object","property","Object","prototype","hasOwnProperty","call","__esModule","max","MAX_SAFE_INTEGER","idCounter","start","Math","floor","random","util","EventEmitter","R","Reflect","ReflectApply","apply","target","receiver","args","Function","safeApply","context","err","inherits","type","i","arguments","length","push","doError","events","_events","undefined","error","er","Error","message","len","listeners","arr","n","copy","Array","arrayClone","req","res","next","originalId","id","newId","getUniqueId_1","done","asyncMiddleware","end","nextPromise","resolveNextPromise","returnHandlerCallback","nextWasCalled","asyncNext","runReturnHandlersCallback","handlers","method","result","enumerable","get","classes_1","utils_1","errors_1","error_constants_1","getEthJsonRpcError","code","arg","parseOpts","data","getEthProviderError","isArray","rpc","parse","invalidRequest","invalidParams","methodNotFound","internal","server","isInteger","invalidInput","resourceNotFound","resourceUnavailable","transactionRejected","methodNotSupported","limitExceeded","provider","userRejectedRequest","unauthorized","unsupportedMethod","disconnected","chainDisconnected","custom","middlewareStack","engine","JsonRpcEngine_1","forEach","middleware","asMiddleware","EthQuery","pify","BaseFilterWithHistory","bnToHex","incrementHexInt","minBlockRef","blockRefIsNumber","LogFilter","params","ethQuery","assign","fromBlock","toBlock","address","topics","toLowerCase","_fetchLogs","newLogs","addInitialResults","matchingLogs","filter","log","matchLog","addResults","cb","getLogs","blockNumber","normalizedLogAddress","every","topicPattern","index","logTopic","subtopicsToMatch","topic","processFn","fn","options","proxy","unwrapped","arguments_","P","promiseModule","reject","multiArgs","errorFirst","shift","self","filterCache","WeakMap","input","exclude","objectType","TypeError","cache","Proxy","thisArg","cached","pified","excludeMain","set","key","match","pattern","test","desc","getOwnPropertyDescriptor","writableOrConfigurableOwn","writable","configurable","shouldFilter","include","some","allResults","newResults","concat","BaseFilter","getBlocksForRange","BlockFilter","blockBodies","blockHashes","block","hash","TxFilter","blocks","blockTxHashes","transactions","Semaphore","_maxConcurrency","_queue","_value","acquire","_this","locked","isLocked","ticket","r","_dispatch","runExclusive","callback","__awaiter","_a","value","release","__generator","_b","label","sent","trys","_currentReleaser","releaser","nextConsumer","released","Mutex","_semaphore","withTimeout","sync","timeout","timeoutError","isTimeout","arrayWithoutHoles","iterableToArray","unsupportedIterableToArray","nonIterableSpread","sortBlockRefs","refs","sort","refA","refB","hexString","intToHex","int","toString","unsafeRandomNibble","maxBlockRef","sortedRefs","bn","blockRef","unsafeRandomBytes","byteCount","source","events_1","EthereumRpcError","serialized","stack","fast_safe_stringify_1","serialize","stringifyReplacer","EthereumProviderError","isValidEthProviderCode","_","standard","updates","default","fromBlockNumber","toBlockNumber","missingBlockNumbers","fill","all","blockNum","query","sendAsync","jsonrpc","PollingBlockTracker","pollingInterval","retryTimeout","keepEventLoopActive","setSkipCacheFlag","_provider","_pollingInterval","_retryTimeout","_keepEventLoopActive","_setSkipCacheFlag","_updateLatestBlock","getLatestBlock","_performSync","catch","newErr","emitErr","console","_fetchLatestBlock","_newPotentialLatest","skipCache","duration","timoutRef","results","unshift","obj","ret","create","x","superPropBase","_get","base","extend","createRandomId","currentProvider","generateFnFor","methodName","slice","pop","generateFnWithDefaultBlockFor","argCount","getBalance","getCode","getTransactionCount","getStorageAt","protocolVersion","syncing","coinbase","mining","hashrate","gasPrice","accounts","getBlockTransactionCountByHash","getBlockTransactionCountByNumber","getUncleCountByBlockHash","getUncleCountByBlockNumber","sign","sendTransaction","sendRawTransaction","estimateGas","getBlockByHash","getBlockByNumber","getTransactionByHash","getTransactionByBlockHashAndIndex","getTransactionByBlockNumberAndIndex","getTransactionReceipt","getUncleByBlockHashAndIndex","getUncleByBlockNumberAndIndex","getCompilers","compileLLL","compileSolidity","compileSerpent","newFilter","newBlockFilter","newPendingTransactionFilter","uninstallFilter","getFilterChanges","getFilterLogs","getWork","submitWork","submitHashrate","response","createAsyncMiddleware","createJsonRpcMiddleware","toFilterCreationMiddleware","createFilterFn","toAsyncRpcMiddleware","asyncFn","objValues","values","blockTracker","filterIndex","filters","mutex","waitForFree","releaseLock","mutexMiddlewareWrapper","eth_newFilter","newLogFilter","eth_newBlockFilter","eth_newPendingTransactionFilter","eth_uninstallFilter","uninstallFilterHandler","eth_getFilterChanges","eth_getFilterLogs","filterUpdater","update","destroy","uninstallAllFilters","installFilter","filterIndexHex","getChangesAndClear","getAllResults","Boolean","prevFilterCount","initialize","idHex","newFilterCount","updateBlockTrackerSubs","__exportStar","MAX","JsonRpcEngine","_middleware","_handleBatch","_handle","_promiseHandle","_runAllMiddleware","middlewareError","isComplete","returnHandlers","_runReturnHandlers","handlerCallback","reqs","responses","_err","callerReq","eth_rpc_errors_1","request","_processRequest","_checkForCompletion","_runMiddleware","reverse","returnHandler","jsonify","safe_event_emitter_1","JSON","stringify","stable","deterministicStringify","stableStringify","LIMIT_REPLACE_NODE","CIRCULAR_REPLACE_NODE","replacerStack","defaultOptions","depthLimit","edgesLimit","replacer","spacer","decirc","replaceGetterValues","part","defineProperty","setReplace","replace","val","k","parent","propertyDescriptor","edgeIndex","depth","keys","compareFunction","a","b","tmp","deterministicDecirc","toJSON","v","splice","FALLBACK_ERROR_CODE","FALLBACK_MESSAGE","FALLBACK_ERROR","getMessageFromCode","fallbackMessage","codeString","hasKey","isJsonRpcServerError","isValidCode","assignOriginalError","fallbackError","shouldIncludeStack","_error","originalError","createScaffoldMiddleware","createFilterMiddleware","normalizeBlock","parentHash","sha3Uncles","miner","stateRoot","transactionsRoot","receiptsRoot","logsBloom","difficulty","number","gasLimit","gasUsed","nonce","mixHash","timestamp","extraData","subscriptions","filterManager","isDestroyed","eth_subscribe","eth_unsubscribe","removeAllListeners","createSubNewHeads","createSubFromFilter","subId","_emitSubscriptionResult","sub","subscriptionType","rawBlocks","filterParams","subscription","filterIdHex","arrayLikeToArray","iter","Symbol","iterator","from"],"mappings":"6OAEMA,GAFWC,EAAQ,KACZA,EAAQ,KACIA,EAAQ,OAE3BC,EAAM,IAENC,EAAe,SAACC,EAAaC,GAAY,OAAKD,EAAcC,CAAY,EACxEC,EAAqB,CAAC,OAAQ,UAE9BC,EAAgB,2CAMpB,aAAwB,MAAXC,EAAO,UAAH,6CAAG,CAAC,EAaQ,OAbP,WACpB,gBAEKC,oBAAsBD,EAAKE,oBAAsB,GAAKR,EAE3D,EAAKS,mBACL,EAAKC,cAAgB,KACrB,EAAKC,YAAa,EAElB,EAAKC,eAAiB,EAAKA,eAAeC,KAAK,EAAD,IAC9C,EAAKC,kBAAoB,EAAKA,kBAAkBD,KAAK,EAAD,IACpD,EAAKE,mBAAqB,EAAKA,mBAAmBF,KAAK,EAAD,IAEtD,EAAKG,uBAAsB,CAC7B,CA0HC,OA1HA,4BAED,WACE,OAAOC,KAAKN,UACd,GAAC,6BAED,WACE,OAAOM,KAAKP,aACd,GAAC,yDAED,+FAEMO,KAAKP,cAAe,CAAF,wCAASO,KAAKP,eAAa,uBAEvB,IAAIQ,SAAQ,SAAAC,GAAO,OAAI,EAAKC,KAAK,SAAUD,EAAQ,IAAC,OAA7D,OAAXE,EAAc,EAAH,uBAEVA,GAAW,gDACnB,kDATA,IAWD,gCACA,SAAoBC,GAEdA,EACF,sDAAyBA,GAEzB,uDAGFL,KAAKD,uBAELC,KAAKH,mBACP,GAIA,oBAEA,WACE,GACD,kBAED,WACE,GAKF,kCAEA,WAEEG,KAAKM,eAAe,cAAeN,KAAKL,gBACxCK,KAAKM,eAAe,iBAAkBN,KAAKH,mBAE3CG,KAAKO,GAAG,cAAeP,KAAKL,gBAC5BK,KAAKO,GAAG,iBAAkBP,KAAKH,kBACjC,GAAC,4BAED,SAAgBQ,EAAWG,GAEpBrB,EAAmBsB,SAASJ,IACjCL,KAAKU,aACP,GAAC,+BAED,SAAmBL,EAAWG,GAExBR,KAAKW,6BAA+B,GACxCX,KAAKY,WACP,GAAC,yBAED,WACMZ,KAAKN,aACTM,KAAKN,YAAa,EAElBM,KAAKa,2BACLb,KAAKc,SACP,GAAC,uBAED,WACOd,KAAKN,aACVM,KAAKN,YAAa,EAClBM,KAAKe,0BACLf,KAAKgB,OACP,GAAC,wCAED,WAA8B,WAC5B,OAAO7B,EACJ8B,KAAI,SAAAZ,GAAS,OAAI,EAAKa,cAAcb,EAAU,IAC9Cc,OAAOnC,EACZ,GAAC,iCAED,SAAqBoC,GACnB,IAAMC,EAAerB,KAAKP,cAEtB4B,GAAiBC,EAASF,IAAaE,EAASD,IACpDrB,KAAKuB,iBAAiBH,EACxB,GAAC,8BAED,SAAkBA,GAChB,IAAMI,EAAWxB,KAAKP,cACtBO,KAAKP,cAAgB2B,EACrBpB,KAAKyB,KAAK,SAAUL,GACpBpB,KAAKyB,KAAK,OAAQ,CAAED,WAAUJ,YAChC,GAAC,qCAED,WAEEpB,KAAKa,2BAELb,KAAKR,mBAAqBkC,WAAW1B,KAAKF,mBAAoBE,KAAKV,qBAE/DU,KAAKR,mBAAmBmC,OAC1B3B,KAAKR,mBAAmBmC,OAE5B,GAAC,sCAED,WACEC,aAAa5B,KAAKR,mBACpB,GAAC,gCAED,WACEQ,KAAKP,cAAgB,IACvB,KAAC,EA9ImB,CAASZ,GAoJ/B,SAASyC,EAASO,GAChB,OAAOC,OAAOC,SAASF,EAAQ,GACjC,CAJAG,EAAOC,QAAU7C,C,uBC3JjB,IAAI8C,EAAiB,EAAQ,KAQ7BF,EAAOC,QAPP,SAAwBE,EAAQC,GAC9B,MAAQC,OAAOC,UAAUC,eAAeC,KAAKL,EAAQC,IAEpC,QADfD,EAASD,EAAeC,MAG1B,OAAOA,CACT,EACiCH,EAAOC,QAAQQ,YAAa,EAAMT,EAAOC,QAAiB,QAAID,EAAOC,O,qBCRtGD,EAAOC,QAEP,SAAoB5C,GAElB,IAAIqD,GADJrD,EAAOA,GAAQ,CAAC,GACDqD,KAAOZ,OAAOa,iBACzBC,EAAkC,qBAAfvD,EAAKwD,MAAwBxD,EAAKwD,MAAQC,KAAKC,MAAMD,KAAKE,SAAWN,GAE5F,OAAO,WAEL,OADAE,GAAwBF,EACjBE,GACT,CAEF,C,uBCZA,IAAMK,EAAOnE,EAAQ,KACfoE,EAAepE,EAAQ,IAEzBqE,EAAuB,kBAAZC,QAAuBA,QAAU,KAC5CC,EAAeF,GAAwB,oBAAZA,EAAEG,MAC7BH,EAAEG,MACF,SAAsBC,EAAQC,EAAUC,GACxC,OAAOC,SAASpB,UAAUgB,MAAMd,KAAKe,EAAQC,EAAUC,EAC3D,EAKA,SAAS5E,IACPqE,EAAaV,KAAKxC,KACpB,CAoDA,SAAS2D,EAAUnD,EAASoD,EAASH,GACnC,IACEJ,EAAa7C,EAASoD,EAASH,EAMjC,CALE,MAAOI,GAEPnC,YAAW,WACT,MAAMmC,CACR,GACF,CACF,CAlEA7B,EAAOC,QAAUpD,EAOjBoE,EAAKa,SAASjF,EAAkBqE,GAEhCrE,EAAiByD,UAAUb,KAAO,SAAUsC,GAI1C,IADA,IAAIN,EAAO,GACFO,EAAI,EAAGA,EAAIC,UAAUC,OAAQF,IAAKP,EAAKU,KAAKF,UAAUD,IAC/D,IAAII,EAAoB,UAATL,EAEXM,EAASrE,KAAKsE,QAClB,QAAeC,IAAXF,EACFD,EAAWA,QAA4BG,IAAjBF,EAAOG,WAC1B,IAAKJ,EACR,OAAO,EAGT,GAAIA,EAAS,CACX,IAAIK,EAGJ,GAFIhB,EAAKS,OAAS,IAChBO,EAAKhB,EAAK,IACRgB,aAAcC,MAGhB,MAAMD,EAGR,IAAIZ,EAAM,IAAIa,MAAM,oBAAsBD,EAAK,KAAOA,EAAGE,QAAU,IAAM,KAEzE,MADAd,EAAID,QAAUa,EACRZ,CACR,CAEA,IAAIrD,EAAU6D,EAAON,GAErB,QAAgBQ,IAAZ/D,EACF,OAAO,EAET,GAAuB,oBAAZA,EAETmD,EAAUnD,EAASR,KAAMyD,OAEzB,KAAImB,EAAMpE,EAAQ0D,OACdW,EAoBR,SAAoBC,EAAKC,GAEvB,IADA,IAAIC,EAAO,IAAIC,MAAMF,GACZf,EAAI,EAAGA,EAAIe,IAAKf,EACvBgB,EAAKhB,GAAKc,EAAId,GAChB,OAAOgB,CACT,CAzBoBE,CAAW1E,EAASoE,GACpC,IAASZ,EAAI,EAAGA,EAAIY,IAAOZ,EAEzBL,EAAUkB,EAAUb,GAAIhE,KAAMyD,EAJR,CAO1B,OAAO,CACT,C,sHCjEA,aAGAxB,0BAAA,WACE,OAAO,SAACkD,EAAKC,EAAKC,EAAMrE,GACtB,IAAMsE,EAAaH,EAAII,GACjBC,EAAQC,gBACdN,EAAII,GAAKC,EACTJ,EAAIG,GAAKC,EACTH,GAAK,SAACK,GACJP,EAAII,GAAKD,EACTF,EAAIG,GAAKD,EACTI,GACF,GACF,CACF,C,0JCkBAzD,wBAAA,SACE0D,GAEA,oCAAO,WAAOR,EAAKC,EAAKC,EAAMO,GAAG,+EAahB,OARTC,EAAc,IAAI5F,SAAQ,SAACC,GAC/B4F,EAAqB5F,CACvB,IAEI6F,EAAiC,KACjCC,GAAgB,EAGdC,EAAS,6BAAG,8EAUb,OATHD,GAAgB,EAKhBX,GAAK,SAACa,GAEJH,EAAwBG,EACxBJ,GACF,IAAG,SACGD,EAAW,2CAClB,kBAZc,qDAePF,EAAgBR,EAAKC,EAAKa,GAAU,WAEtCD,EAAa,kCACTH,EAAW,QAChBE,EAAgD,MAAM,wBAEvDH,EAAI,MAAM,0DAGRG,EACDA,EAA+C,MAEhDH,EAAG,MACJ,0DAEJ,yDA3CD,EA4CF,C,uHC5EA3D,2BAAA,SAAyCkE,GAGvC,OAAO,SAAChB,EAAKC,EAAKC,EAAMO,GACtB,IAAMpF,EAAU2F,EAAShB,EAAIiB,QAE7B,YAAgB7B,IAAZ/D,EACK6E,IAGc,oBAAZ7E,EACFA,EAAQ2E,EAAKC,EAAKC,EAAMO,IAGhCR,EAAgCiB,OAAS7F,EACnCoF,IACT,CACF,C,sMCrBA,aAUEvD,4CAAAiE,cAAAC,eAAA,OAVOC,kBAAgB,IAWvBnE,iDAAAiE,cAAAC,eAAA,OAXyBC,uBAAqB,IAChD,aAWEnE,0CAAAiE,cAAAC,eAAA,OAVAE,gBAAc,IAWdpE,8CAAAiE,cAAAC,eAAA,OAXgBE,oBAAkB,IAEpC,cAKEpE,qCAAAiE,cAAAC,eAAA,OALOG,WAAS,IAClB,aAGErE,sCAAAiE,cAAAC,eAAA,OAHOI,YAAU,G,4HCLnB,aACA,SACA,SAuLA,SAASC,EAAsBC,EAAcC,GAC3C,MAAwBC,EAAUD,GAAI,SAA/BnC,EAAO,KAAEqC,EAAI,KACpB,OAAO,IAAIR,mBACTK,EACAlC,GAAW8B,qBAAmBI,GAC9BG,EAEJ,CAEA,SAASC,EAAuBJ,EAAcC,GAC5C,MAAwBC,EAAUD,GAAI,SAA/BnC,EAAO,KAAEqC,EAAI,KACpB,OAAO,IAAIR,wBACTK,EACAlC,GAAW8B,qBAAmBI,GAC9BG,EAEJ,CAEA,SAASD,EAAaD,GACpB,GAAIA,EAAK,CACP,GAAmB,kBAARA,EACT,MAAO,CAACA,GACH,GAAmB,kBAARA,IAAqB7B,MAAMiC,QAAQJ,GAAM,CACzD,IAAQnC,EAAkBmC,EAAlBnC,QAASqC,EAASF,EAATE,KAEjB,GAAIrC,GAA8B,kBAAZA,EACpB,MAAM,IAAID,MAAM,gCAElB,MAAO,CAACC,QAAWJ,EAAWyC,E,EAGlC,MAAO,EACT,CAxMa/E,YAAY,CACvBkF,IAAK,CAKHC,MAAO,SAAIN,GAAqB,OAAKF,EACnCD,aAAWQ,IAAIC,MAAON,EACvB,EAKDO,eAAgB,SAAIP,GAAqB,OAAKF,EAC5CD,aAAWQ,IAAIE,eAAgBP,EAChC,EAKDQ,cAAe,SAAIR,GAAqB,OAAKF,EAC3CD,aAAWQ,IAAIG,cAAeR,EAC/B,EAKDS,eAAgB,SAAIT,GAAqB,OAAKF,EAC5CD,aAAWQ,IAAII,eAAgBT,EAChC,EAKDU,SAAU,SAAIV,GAAqB,OAAKF,EACtCD,aAAWQ,IAAIK,SAAUV,EAC1B,EAODW,OAAQ,SAAIpI,GACV,IAAKA,GAAwB,kBAATA,GAAqB4F,MAAMiC,QAAQ7H,GACrD,MAAM,IAAIqF,MAAM,mEAElB,IAAQmC,EAASxH,EAATwH,KACR,IAAK/E,OAAO4F,UAAUb,IAASA,GAAQ,OAASA,GAAQ,MACtD,MAAM,IAAInC,MACR,iEAGJ,OAAOkC,EAAmBC,EAAMxH,EAClC,EAKAsI,aAAc,SAAIb,GAAqB,OAAKF,EAC1CD,aAAWQ,IAAIQ,aAAcb,EAC9B,EAKDc,iBAAkB,SAAId,GAAqB,OAAKF,EAC9CD,aAAWQ,IAAIS,iBAAkBd,EAClC,EAKDe,oBAAqB,SAAIf,GAAqB,OAAKF,EACjDD,aAAWQ,IAAIU,oBAAqBf,EACrC,EAKDgB,oBAAqB,SAAIhB,GAAqB,OAAKF,EACjDD,aAAWQ,IAAIW,oBAAqBhB,EACrC,EAKDiB,mBAAoB,SAAIjB,GAAqB,OAAKF,EAChDD,aAAWQ,IAAIY,mBAAoBjB,EACpC,EAKDkB,cAAe,SAAIlB,GAAqB,OAAKF,EAC3CD,aAAWQ,IAAIa,cAAelB,EAC/B,GAGHmB,SAAU,CAKRC,oBAAqB,SAAIpB,GACvB,OAAOG,EACLN,aAAWsB,SAASC,oBAAqBpB,EAE7C,EAKAqB,aAAc,SAAIrB,GAChB,OAAOG,EACLN,aAAWsB,SAASE,aAAcrB,EAEtC,EAKAsB,kBAAmB,SAAItB,GACrB,OAAOG,EACLN,aAAWsB,SAASG,kBAAmBtB,EAE3C,EAKAuB,aAAc,SAAIvB,GAChB,OAAOG,EACLN,aAAWsB,SAASI,aAAcvB,EAEtC,EAKAwB,kBAAmB,SAAIxB,GACrB,OAAOG,EACLN,aAAWsB,SAASK,kBAAmBxB,EAE3C,EAKAyB,OAAQ,SAAIlJ,GACV,IAAKA,GAAwB,kBAATA,GAAqB4F,MAAMiC,QAAQ7H,GACrD,MAAM,IAAIqF,MAAM,wEAGlB,IAAQmC,EAAwBxH,EAAxBwH,KAAMlC,EAAkBtF,EAAlBsF,QAASqC,EAAS3H,EAAT2H,KAEvB,IAAKrC,GAA8B,kBAAZA,EACrB,MAAM,IAAID,MACR,uCAGJ,OAAO,IAAI8B,wBAAsBK,EAAMlC,EAASqC,EAClD,G,8GCnLJ,aAEA/E,kBAAA,SAAgCuG,GAC9B,IAAMC,EAAS,IAAIC,gBAEnB,OADAF,EAAgBG,SAAQ,SAACC,GAAU,OAAKH,EAAOtE,KAAKyE,EAAW,IACxDH,EAAOI,cAChB,C,qBCNA7G,EAAOC,QAAU,SAAmCkE,GAClD,OAAO,SAAChB,EAAKC,EAAKC,EAAMO,GACtB,IAAMpF,EAAU2F,EAAShB,EAAIiB,QAE7B,YAAgB7B,IAAZ/D,EACK6E,IAGc,oBAAZ7E,EACFA,EAAQ2E,EAAKC,EAAKC,EAAMO,IAGjCR,EAAIiB,OAAS7F,EACNoF,IACT,CACF,C,+HCfMkD,EAAWhK,EAAQ,KACnBiK,EAAOjK,EAAQ,MACfkK,EAAwBlK,EAAQ,MACtC,EAA8EA,EAAQ,KAArEwC,GAAF,EAAP2H,QAAiB,EAAR3H,UAAU4H,EAAe,EAAfA,gBAAiBC,EAAW,EAAXA,YAAaC,EAAgB,EAAhBA,iBAEnDC,EAAS,2CAEb,cAAmC,MAApBpB,EAAQ,EAARA,SAAUqB,EAAM,EAANA,OAkBtB,OAlB4B,WAC7B,gBACKvF,KAAO,MACZ,EAAKwF,SAAW,IAAIT,EAASb,GAC7B,EAAKqB,OAASjH,OAAOmH,OAAO,CAC1BC,UAAW,SACXC,QAAS,SACTC,aAASpF,EACTqF,OAAQ,IACPN,GAEC,EAAKA,OAAOK,UAET1E,MAAMiC,QAAQ,EAAKoC,OAAOK,WAC7B,EAAKL,OAAOK,QAAU,CAAC,EAAKL,OAAOK,UAGrC,EAAKL,OAAOK,QAAU,EAAKL,OAAOK,QAAQ1I,KAAI,SAAA0I,GAAO,OAAIA,EAAQE,aAAa,KAC/E,CACH,CAuEC,OAvEA,0DAED,6FASE,OATiBxI,EAAY,EAAZA,aAEboI,EAAYzJ,KAAKsJ,OAAOG,UACxB,CAAC,SAAU,WAAWhJ,SAASgJ,KAAYA,EAAYpI,GACvD,aAAeoI,IAAWA,EAAY,OAC1CzJ,KAAKsJ,OAAOG,UAAYA,EAElBC,EAAUP,EAAYnJ,KAAKsJ,OAAOI,QAASrI,GAC3CiI,EAASjH,OAAOmH,OAAO,CAAC,EAAGxJ,KAAKsJ,OAAQ,CAAEI,YAChD,SACsB1J,KAAK8J,WAAWR,GAAO,OAAvCS,EAAU,EAAH,KACb/J,KAAKgK,kBAAkBD,GAAQ,iDAChC,mDAdA,IAcA,iDAED,wGAWuE,OAXvDvI,EAAQ,EAARA,SAAUJ,EAAQ,EAARA,SAElBsI,EAAUtI,EAIdqI,EADEjI,EACU0H,EAAgB1H,GAEhBJ,EAGRkI,EAASjH,OAAOmH,OAAO,CAAC,EAAGxJ,KAAKsJ,OAAQ,CAAEG,YAAWC,YAAU,SAC/C1J,KAAK8J,WAAWR,GAAO,OAAvCS,EAAU,EAAH,KACPE,EAAeF,EAAQG,QAAO,SAAAC,GAAG,OAAI,EAAKC,SAASD,EAAI,IAG7DnK,KAAKqK,WAAWJ,GAAa,gDAC9B,mDAnBA,IAmBA,qDAED,WAAkBX,GAAM,8FACAP,GAAK,SAAAuB,GAAE,OAAI,EAAKf,SAASgB,QAAQjB,EAAQgB,EAAG,GAA5CvB,GAA+C,OAAxD,OAAPgB,EAAU,EAAH,uBAENA,GAAO,2CACf,mDANA,IAMA,sBAED,SAASI,GAEP,GAAI7I,EAAStB,KAAKsJ,OAAOG,YAAcnI,EAAS6I,EAAIK,aAAc,OAAO,EACzE,GAAIpB,EAAiBpJ,KAAKsJ,OAAOI,UAAYpI,EAAStB,KAAKsJ,OAAOI,UAAYpI,EAAS6I,EAAIK,aAAc,OAAO,EAGhH,IAAMC,EAAuBN,EAAIR,SAAWQ,EAAIR,QAAQE,cACxD,QAAI7J,KAAKsJ,OAAOK,SAAWc,IAAyBzK,KAAKsJ,OAAOK,QAAQlJ,SAASgK,KAM7DzK,KAAKsJ,OAAOM,OAAOc,OAAM,SAACC,EAAcC,GAE1D,IAAIC,EAAWV,EAAIP,OAAOgB,GAC1B,IAAKC,EAAU,OAAO,EACtBA,EAAWA,EAAShB,cAEpB,IAAIiB,EAAmB7F,MAAMiC,QAAQyD,GAAgBA,EAAe,CAACA,GAGrE,QADiCG,EAAiBrK,SAAS,QAE3DqK,EAAmBA,EAAiB7J,KAAI,SAAA8J,GAAK,OAAIA,EAAMlB,aAAa,KAE5BpJ,SAASoK,EAEnD,GAGF,KAAC,EA5FY,CAAS7B,GAgGxBhH,EAAOC,QAAUoH,C,oCCrGJ,qBAEP2B,EAAY,SAACC,EAAIC,EAASC,EAAOC,GAAS,OAAK,WAAyB,kCAAZC,EAAU,yBAAVA,EAAU,gBAG3E,OAAO,IAAIC,EAFDJ,EAAQK,gBAEL,SAACrL,EAASsL,GAClBN,EAAQO,UACXJ,EAAWlH,MAAK,WAAe,2BAAXkC,EAAM,yBAANA,EAAM,gBACrB6E,EAAQQ,WACPrF,EAAO,GACVmF,EAAOnF,IAEPA,EAAOsF,QACPzL,EAAQmG,IAGTnG,EAAQmG,EAEV,IACU6E,EAAQQ,WAClBL,EAAWlH,MAAK,SAACK,EAAO6B,GACnB7B,EACHgH,EAAOhH,GAEPtE,EAAQmG,EAEV,IAEAgF,EAAWlH,KAAKjE,GAGjB,IAAM0L,EAAO,IAAST,EAAQC,EAAY,EAC1ChI,QAAQE,MAAM2H,EAAIW,EAAMP,EACzB,GACD,CAAC,EAEKQ,EAAc,IAAIC,QAExB9J,EAAOC,QAAU,SAAC8J,EAAOb,GACxBA,EAAU,EAAH,CACNc,QAAS,CAAC,sBACVN,YAAY,EACZH,cAAetL,SACZiL,GAGJ,IAAMe,SAAoBF,EAC1B,GAAgB,OAAVA,GAAkC,WAAfE,GAA0C,aAAfA,EACnD,MAAM,IAAIC,UAAU,yDAAD,OAA2E,OAAVH,EAAiB,OAASE,EAAU,MAGzH,IAqBME,EAAQ,IAAIL,QAEZX,EAAQ,IAAIiB,MAAML,EAAO,CAC9BzI,MAAK,SAACC,EAAQ8I,EAAS5I,GACtB,IAAM6I,EAASH,EAAM5F,IAAIhD,GAEzB,GAAI+I,EACH,OAAOlJ,QAAQE,MAAMgJ,EAAQD,EAAS5I,GAGvC,IAAM8I,EAASrB,EAAQsB,YAAcjJ,EAASyH,EAAUzH,EAAQ2H,EAASC,EAAO5H,GAEhF,OADA4I,EAAMM,IAAIlJ,EAAQgJ,GACXnJ,QAAQE,MAAMiJ,EAAQF,EAAS5I,EACvC,EAEA8C,IAAG,SAAChD,EAAQmJ,GACX,IAAMtK,EAAWmB,EAAOmJ,GAGxB,IAxCa,SAACnJ,EAAQmJ,GACvB,IAAIJ,EAAST,EAAYtF,IAAIhD,GAO7B,GALK+I,IACJA,EAAS,CAAC,EACVT,EAAYY,IAAIlJ,EAAQ+I,IAGrBI,KAAOJ,EACV,OAAOA,EAAOI,GAGf,IAAMC,EAAQ,SAAAC,GAAO,MAAwB,kBAAZA,GAAuC,kBAARF,EAAoBA,IAAQE,EAAUA,EAAQC,KAAKH,EAAI,EACjHI,EAAO1J,QAAQ2J,yBAAyBxJ,EAAQmJ,GAChDM,OAAsCzI,IAATuI,GAAsBA,EAAKG,UAAYH,EAAKI,aAEzEC,GADWjC,EAAQkC,QAAUlC,EAAQkC,QAAQC,KAAKV,IAAUzB,EAAQc,QAAQqB,KAAKV,KACtDK,EAEjC,OADAV,EAAOI,GAAOS,EACPA,CACR,CAqBOjD,CAAO3G,EAAQmJ,IAAQtK,IAAasB,SAASpB,UAAUoK,GAC3D,OAAOtK,EAGR,IAAMkK,EAASH,EAAM5F,IAAInE,GAEzB,GAAIkK,EACH,OAAOA,EAGR,GAAwB,oBAAblK,EAAyB,CACnC,IAAMmK,EAASvB,EAAU5I,EAAU8I,EAASC,EAAO5H,GAEnD,OADA4I,EAAMM,IAAIrK,EAAUmK,GACbA,CACR,CAEA,OAAOnK,CACR,IAGD,OAAO+I,CACR,C,iKC7GMnC,EAAqB,2CAEzB,aAAe,MAEO,OAFP,WACb,gBACKsE,WAAa,GAAE,CACtB,CAkBC,OAlBA,sDAED,oFACQ,IAAI5I,MAAM,sDAAqD,2CACtE,kDAJA,IAIA,wBAED,SAAY6I,GACVvN,KAAKsN,WAAatN,KAAKsN,WAAWE,OAAOD,GACzC,8CAAiBA,EACnB,GAAC,+BAED,SAAmBA,GACjBvN,KAAKsN,WAAatN,KAAKsN,WAAWE,OAAOD,GACzC,qDAAwBA,EAC1B,GAAC,2BAED,WACE,OAAOvN,KAAKsN,UACd,KAAC,EAvBwB,CAHRxO,EAAQ,MA8B3BkD,EAAOC,QAAU+G,C,+HC9BXyE,EAAa3O,EAAQ,KACrB4O,EAAoB5O,EAAQ,KAC1BoK,EAAoBpK,EAAQ,KAA5BoK,gBAEFyE,EAAW,2CAEf,cAAmC,MAApB1F,EAAQ,EAARA,SAAgB,EAANqB,OAGC,OAHK,WAC7B,gBACKvF,KAAO,QACZ,EAAKkE,SAAWA,EAAQ,CAC1B,CAQC,OARA,sDAED,+FAE6C,OAF7BzG,EAAQ,EAARA,SAAUJ,EAAQ,EAARA,SAClBsI,EAAUtI,EACVqI,EAAYP,EAAgB1H,GAAS,SACjBkM,EAAkB,CAAEzF,SAAUjI,KAAKiI,SAAUwB,YAAWC,YAAU,OAAtFkE,EAAc,EAAH,KACXC,EAAcD,EAAY3M,KAAI,SAAC6M,GAAK,OAAKA,EAAMC,IAAI,IACzD/N,KAAKqK,WAAWwD,GAAY,gDAC7B,mDARA,MAQA,EAdc,CAASJ,GAkB1BzL,EAAOC,QAAU0L,C,iKCtBXF,EAAa3O,EAAQ,KACrB4O,EAAoB5O,EAAQ,KAC1BoK,EAAoBpK,EAAQ,KAA5BoK,gBAEF8E,EAAQ,2CAEZ,cAA2B,MAAZ/F,EAAQ,EAARA,SAGW,OAHH,WACrB,gBACKlE,KAAO,KACZ,EAAKkE,SAAWA,EAAQ,CAC1B,CAYC,OAZA,sDAED,mGAE6C,OAF7BzG,EAAQ,EAARA,SACRkI,EAAUlI,EACViI,EAAYP,EAAgB1H,GAAS,SACtBkM,EAAkB,CAAEzF,SAAUjI,KAAKiI,SAAUwB,YAAWC,YAAU,OAAjFuE,EAAS,EAAH,KACNC,EAAgB,GAAE,IACJD,GAAM,IAA1B,IAAK,EAAL,qBAAWH,EAAK,QACdI,EAAc/J,KAAI,MAAlB+J,EAAa,EAASJ,EAAMK,cAE9B,+BACAnO,KAAKqK,WAAW6D,GAAc,iDAC/B,mDAZA,MAYA,EAlBW,CAAST,GAsBvBzL,EAAOC,QAAU+L,C,mLC2CFI,EApEgB,WAC3B,SAASA,EAAUC,GAGf,GAFArO,KAAKqO,gBAAkBA,EACvBrO,KAAKsO,OAAS,GACVD,GAAmB,EACnB,MAAM,IAAI3J,MAAM,qDAEpB1E,KAAKuO,OAASF,CAClB,CA0DA,OAzDAD,EAAU9L,UAAUkM,QAAU,WAC1B,IAAIC,EAAQzO,KACR0O,EAAS1O,KAAK2O,WACdC,EAAS,IAAI3O,SAAQ,SAAU4O,GAAK,OAAOJ,EAAMH,OAAOnK,KAAK0K,EAAI,IAGrE,OAFKH,GACD1O,KAAK8O,YACFF,CACX,EACAR,EAAU9L,UAAUyM,aAAe,SAAUC,GACzC,OAAOC,YAAUjP,UAAM,OAAQ,GAAQ,WACnC,IAAIkP,EAAIC,EAAOC,EACf,OAAOC,YAAYrP,MAAM,SAAUsP,GAC/B,OAAQA,EAAGC,OACP,KAAK,EAAG,MAAO,CAAC,EAAavP,KAAKwO,WAClC,KAAK,EACDU,EAAKI,EAAGE,OAAQL,EAAQD,EAAG,GAAIE,EAAUF,EAAG,GAC5CI,EAAGC,MAAQ,EACf,KAAK,EAED,OADAD,EAAGG,KAAKtL,KAAK,CAAC,EAAE,CAAG,EAAG,IACf,CAAC,EAAa6K,EAASG,IAClC,KAAK,EAAG,MAAO,CAAC,EAAcG,EAAGE,QACjC,KAAK,EAED,OADAJ,IACO,CAAC,GACZ,KAAK,EAAG,MAAO,CAAC,GAExB,GACJ,GACJ,EACAhB,EAAU9L,UAAUqM,SAAW,WAC3B,OAAO3O,KAAKuO,QAAU,CAC1B,EACAH,EAAU9L,UAAU8M,QAAU,WAC1B,GAAIpP,KAAKqO,gBAAkB,EACvB,MAAM,IAAI3J,MAAM,qHAEpB,GAAI1E,KAAK0P,iBAAkB,CACvB,IAAIC,EAAW3P,KAAK0P,iBACpB1P,KAAK0P,sBAAmBnL,EACxBoL,GACJ,CACJ,EACAvB,EAAU9L,UAAUwM,UAAY,WAC5B,IAAIL,EAAQzO,KACR4P,EAAe5P,KAAKsO,OAAO3C,QAC/B,GAAKiE,EAAL,CAEA,IAAIC,GAAW,EACf7P,KAAK0P,iBAAmB,WAChBG,IAEJA,GAAW,EACXpB,EAAMF,SACNE,EAAMK,YACV,EACAc,EAAa,CAAC5P,KAAKuO,SAAUvO,KAAK0P,kBATxB,CAUd,EACOtB,CACX,CAnE+B,GC6BhB0B,EA5BY,WACvB,SAASA,IACL9P,KAAK+P,WAAa,IAAI3B,EAAU,EACpC,CAuBA,OAtBA0B,EAAMxN,UAAUkM,QAAU,WACtB,OAAOS,YAAUjP,UAAM,OAAQ,GAAQ,WACnC,IAAIkP,EACJ,OAAOG,YAAYrP,MAAM,SAAUsP,GAC/B,OAAQA,EAAGC,OACP,KAAK,EAAG,MAAO,CAAC,EAAavP,KAAK+P,WAAWvB,WAC7C,KAAK,EAED,OADAU,EAAKI,EAAGE,OACD,CAAC,EADmBN,EAAG,IAG1C,GACJ,GACJ,EACAY,EAAMxN,UAAUyM,aAAe,SAAUC,GACrC,OAAOhP,KAAK+P,WAAWhB,cAAa,WAAc,OAAOC,GAAY,GACzE,EACAc,EAAMxN,UAAUqM,SAAW,WACvB,OAAO3O,KAAK+P,WAAWpB,UAC3B,EACAmB,EAAMxN,UAAU8M,QAAU,WACtBpP,KAAK+P,WAAWX,SACpB,EACOU,CACX,CA3B2B,GCApB,SAASE,EAAYC,EAAMC,EAASC,GACvC,IAAI1B,EAAQzO,KAEZ,YADqB,IAAjBmQ,IAA2BA,EAAe,IAAIzL,MAAM,YACjD,CACH8J,QAAS,WACL,OAAO,IAAIvO,SAAQ,SAAUC,EAASsL,GAAU,OAAOyD,YAAUR,OAAO,OAAQ,GAAQ,WACpF,IAAI2B,EAAWxB,EACf,OAAOS,YAAYrP,MAAM,SAAUkP,GAC/B,OAAQA,EAAGK,OACP,KAAK,EAMD,OALAa,GAAY,EACZ1O,YAAW,WACP0O,GAAY,EACZ5E,EAAO2E,EACX,GAAGD,GACI,CAAC,EAAaD,EAAKzB,WAC9B,KAAK,EASD,OARAI,EAASM,EAAGM,OACRY,GACUnL,MAAMiC,QAAQ0H,GAAUA,EAAO,GAAKA,KAI9C1O,EAAQ0O,GAEL,CAAC,GAEpB,GACJ,GAAI,GACR,EACAG,aAAc,SAAUC,GACpB,OAAOC,YAAUjP,UAAM,OAAQ,GAAQ,WACnC,IAAIoP,EAASR,EACb,OAAOS,YAAYrP,MAAM,SAAUkP,GAC/B,OAAQA,EAAGK,OACP,KAAK,EACDH,EAAU,WAAgC,EAC1CF,EAAGK,MAAQ,EACf,KAAK,EAED,OADAL,EAAGO,KAAKtL,KAAK,CAAC,EAAE,CAAG,EAAG,IACf,CAAC,EAAanE,KAAKwO,WAC9B,KAAK,EAED,OADAI,EAASM,EAAGM,OACPvK,MAAMiC,QAAQ0H,IACnBQ,EAAUR,EAAO,GACV,CAAC,EAAaI,EAASJ,EAAO,MAFF,CAAC,EAAa,GAGrD,KAAK,EAAG,MAAO,CAAC,EAAcM,EAAGM,QACjC,KAAK,EAED,OADAJ,EAAUR,EACH,CAAC,EAAaI,KACzB,KAAK,EAAG,MAAO,CAAC,EAAcE,EAAGM,QACjC,KAAK,EAAG,MAAO,CAAC,EAAa,GAC7B,KAAK,EAED,OADAJ,IACO,CAAC,GACZ,KAAK,EAAG,MAAO,CAAC,GAExB,GACJ,GACJ,EACAA,QAAS,WACLa,EAAKb,SACT,EACAT,SAAU,WAAc,OAAOsB,EAAKtB,UAAY,EAExD,C,sBCnEA,IAAI0B,EAAoB,EAAQ,KAC5BC,EAAkB,EAAQ,KAC1BC,EAA6B,EAAQ,KACrCC,EAAoB,EAAQ,KAIhCxO,EAAOC,QAHP,SAA4B6C,GAC1B,OAAOuL,EAAkBvL,IAAQwL,EAAgBxL,IAAQyL,EAA2BzL,IAAQ0L,GAC9F,EACqCxO,EAAOC,QAAQQ,YAAa,EAAMT,EAAOC,QAAiB,QAAID,EAAOC,O,oBCgB1G,SAASwO,EAAcC,GACrB,OAAOA,EAAKC,MAAK,SAACC,EAAMC,GACtB,MAAa,WAATD,GAA8B,aAATC,EAA4B,EACxC,WAATA,GAA8B,aAATD,GAA6B,EAC/CtP,EAASsP,GAAQtP,EAASuP,EACnC,GACF,CAUA,SAASvP,EAASwP,GAChB,YAAkBvM,IAAduM,GAAyC,OAAdA,EAA2BA,EACnDhP,OAAOC,SAAS+O,EAAW,GACpC,CAQA,SAASC,EAASC,GAChB,QAAYzM,IAARyM,GAA6B,OAARA,EAAc,OAAOA,EAC9C,IAAIF,EAAYE,EAAIC,SAAS,IAG7B,OAFqBH,EAAU5M,OAAS,IACtB4M,EAAY,IAAMA,GAC7B,KAAOA,CAChB,CAWA,SAASI,IACP,OAAOpO,KAAKC,MAAsB,GAAhBD,KAAKE,UAAeiO,SAAS,GACjD,CApEAjP,EAAOC,QAAU,CACfkH,YAWF,WAA8B,2BAANuH,EAAI,yBAAJA,EAAI,gBAE1B,OADmBD,EAAcC,GACf,EACpB,EAbES,YAeF,WAA8B,2BAANT,EAAI,yBAAJA,EAAI,gBAC1B,IAAMU,EAAaX,EAAcC,GACjC,OAAOU,EAAWA,EAAWlN,OAAO,EACtC,EAjBEuM,gBACAxH,QA0BF,SAAiBoI,GACf,MAAO,KAAOA,EAAGJ,SAAS,GAC5B,EA3BE7H,iBA6BF,SAA0BkI,GACxB,OAAOA,IAAa,CAAC,WAAY,SAAU,WAAW7Q,SAAS6Q,EACjE,EA9BEhQ,WACA4H,gBAoCF,SAAyB4H,GACvB,YAAkBvM,IAAduM,GAAyC,OAAdA,EAA2BA,EAEnDC,EADOzP,EAASwP,GACC,EAC1B,EAvCEC,WACAQ,kBAgDF,SAA2BC,GAEzB,IADA,IAAInL,EAAS,KACJrC,EAAI,EAAGA,EAAIwN,EAAWxN,IAC7BqC,GAAU6K,IACV7K,GAAU6K,IAEZ,OAAO7K,CACT,E,oBCjEArE,EAAOC,QAIP,WAGI,IAFA,IAAIsB,EAAS,CAAC,EAELS,EAAI,EAAGA,EAAIC,UAAUC,OAAQF,IAAK,CACvC,IAAIyN,EAASxN,UAAUD,GAEvB,IAAK,IAAI0I,KAAO+E,EACRlP,EAAeC,KAAKiP,EAAQ/E,KAC5BnJ,EAAOmJ,GAAO+E,EAAO/E,GAGjC,CAEA,OAAOnJ,CACX,EAhBA,IAAIhB,EAAiBF,OAAOC,UAAUC,c,yGCKtC,SAASoB,EAA+BnD,EAAwCoD,EAAYH,GAC1F,IACEL,QAAQE,MAAM9C,EAASoD,EAASH,E,CAChC,MAAOI,GAEPnC,YAAW,WACT,MAAMmC,CACR,G,CAEJ,C,iDASC,IAEoBhF,EAAiB,oFA6CnC,OA7CmC,uBACpC,SAAMkF,GACJ,IAAIK,EAAmB,UAATL,EAERM,EAAoB,KAAaC,QACvC,QAAeC,IAAXF,EACFD,EAAUA,QAA4BG,IAAjBF,EAAOG,WACvB,IAAKJ,EACV,OAAO,EAGT,2BAVqBX,EAAW,iCAAXA,EAAW,kBAWhC,GAAIW,EAAS,CACX,IAAIK,EAIJ,GAHIhB,EAAKS,OAAS,IACfO,EAAMhB,EAAI,IAETgB,aAAcC,MAGhB,MAAMD,EAGR,IAAMZ,EAAM,IAAIa,MAAK,0BAAoBD,EAAE,YAAQA,EAAGE,QAAO,KAAM,KAEnE,MADCd,EAAYD,QAAUa,EACjBZ,C,CAGR,IAAMrD,EAAU6D,EAAON,GAEvB,QAAgBQ,IAAZ/D,EACF,OAAO,EAGT,GAAuB,oBAAZA,EACTmD,EAAUnD,EAAS,KAAMiD,QAIzB,IAFA,IAAMmB,EAAMpE,EAAQ0D,OACdW,EA/CZ,SAAwBC,GAGtB,IAFA,IAAMC,EAAID,EAAIZ,OACRc,EAAO,IAAIC,MAAMF,GACdf,EAAI,EAAGA,EAAIe,EAAGf,GAAK,EAC1BgB,EAAKhB,GAAKc,EAAId,GAEhB,OAAOgB,CACT,CAwCwBE,CAAW1E,GACpBwD,EAAI,EAAGA,EAAIY,EAAKZ,GAAK,EAC5BL,EAAUkB,EAAUb,GAAI,KAAMP,GAIlC,OAAO,CACT,KAAC,EA7CmC,CA3BtC,MA2B8CiO,cAA9CzP,W,6NC3BA,aAca0P,EAAoB,8BAM/B,WAAY9K,EAAclC,EAAiBqC,GAAQ,MAEjD,GAFiD,WAE5ClF,OAAO4F,UAAUb,GACpB,MAAM,IAAInC,MACR,8BAGJ,IAAKC,GAA8B,kBAAZA,EACrB,MAAM,IAAID,MACR,wCAQH,OAJD,cAAMC,IACDkC,KAAOA,OACCtC,IAATyC,IACF,EAAKA,KAAOA,GACb,CACH,CA6BC,OA3BD,4BAGA,WACE,IAAM4K,EAAyC,CAC7C/K,KAAM,KAAKA,KACXlC,QAAS,KAAKA,SAQhB,YANkBJ,IAAd,KAAKyC,OACP4K,EAAW5K,KAAO,KAAKA,MAErB,KAAK6K,QACPD,EAAWC,MAAQ,KAAKA,OAEnBD,CACT,GAEA,sBAIA,WACE,OAAOE,UACL,KAAKC,YACLC,EACA,EAEJ,KAAC,EArD8B,CAqD9B,EArDsCtN,QAAzCzC,qBAwDA,IAIagQ,EAAyB,8BAMpC,WAAYpL,EAAclC,EAAiBqC,GAEzC,GAFiD,WAcrD,SAAgCH,GAC9B,OAAO/E,OAAO4F,UAAUb,IAASA,GAAQ,KAAQA,GAAQ,IAC3D,CAdSqL,CAAuBrL,GAC1B,MAAM,IAAInC,MACR,6DAEH,mBAEKmC,EAAMlC,EAASqC,EACvB,CAAC,YAfmC,CAAQ2K,GAwB9C,SAASK,EAAkBG,EAAYhD,GACrC,GAAc,eAAVA,EAGJ,OAAOA,CACT,CA7BAlN,yB,sHCnDaA,aAAyB,CACpCkF,IAAK,CACHQ,cAAe,KACfC,kBAAmB,MACnBC,qBAAsB,MACtBC,qBAAsB,MACtBC,oBAAqB,MACrBC,eAAgB,MAChBZ,OAAQ,MACRC,gBAAiB,MACjBE,gBAAiB,MACjBD,eAAgB,MAChBE,UAAW,OAEbS,SAAU,CACRC,oBAAqB,KACrBC,aAAc,KACdC,kBAAmB,KACnBC,aAAc,KACdC,kBAAmB,OAIVrG,cAAc,CACzB,SAAU,CACRmQ,SAAU,eACVzN,QAAS,yGAEX,SAAU,CACRyN,SAAU,eACVzN,QAAS,gDAEX,SAAU,CACRyN,SAAU,eACVzN,QAAS,iDAEX,SAAU,CACRyN,SAAU,eACVzN,QAAS,gCAEX,SAAU,CACRyN,SAAU,eACVzN,QAAS,4BAEX,SAAU,CACRyN,SAAU,WACVzN,QAAS,kBAEX,SAAU,CACRyN,SAAU,WACVzN,QAAS,uBAEX,SAAU,CACRyN,SAAU,WACVzN,QAAS,yBAEX,SAAU,CACRyN,SAAU,WACVzN,QAAS,yBAEX,SAAU,CACRyN,SAAU,WACVzN,QAAS,yBAEX,SAAU,CACRyN,SAAU,WACVzN,QAAS,2BAEX,KAAQ,CACNyN,SAAU,WACVzN,QAAS,8BAEX,KAAQ,CACNyN,SAAU,WACVzN,QAAS,4EAEX,KAAQ,CACNyN,SAAU,WACVzN,QAAS,oEAEX,KAAQ,CACNyN,SAAU,WACVzN,QAAS,iDAEX,KAAQ,CACNyN,SAAU,WACVzN,QAAS,0D,8HC3GP8I,EAAU,2CAEd,aAAe,MAEI,OAFJ,WACb,gBACK4E,QAAU,GAAE,CACnB,CAmBC,OAnBA,0DAED,kHAAsB,kDAFrB,IAEqB,iDAEtB,oFACQ,IAAI3N,MAAM,2CAA0C,2CAC3D,kDAJqB,IAIrB,wBAED,SAAY6I,GAAY,WACtBvN,KAAKqS,QAAUrS,KAAKqS,QAAQ7E,OAAOD,GACnCA,EAAW5E,SAAQ,SAAAtC,GAAM,OAAI,EAAK5E,KAAK,SAAU4E,EAAO,GAC1D,GAAC,+BAED,SAAmBkH,GAAa,GAAC,gCAEjC,WACE,IAAM8E,EAAUrS,KAAKqS,QAErB,OADArS,KAAKqS,QAAU,GACRA,CACT,KAAC,EAxBa,CAFSvT,EAAQ,KAAgCwT,SA8BjEtQ,EAAOC,QAAUwL,C,4DC5Be,aAc/B,OAd+B,cAAhC,iGAS4C,OATTxF,EAAQ,EAARA,SAAUwB,EAAS,EAATA,UAAWC,EAAO,EAAPA,QACjDD,IAAWA,EAAYC,GAEtB6I,EAAkBjR,EAASmI,GAC3B+I,EAAgBlR,EAASoI,GAGzB+I,EAAsBxN,MAFFuN,EAAgBD,EAAkB,GAEPG,OACxBzR,KAAI,SAACkR,EAAEvH,GAAK,OAAK2H,EAAkB3H,CAAK,IACxC3J,IAAI8P,GAAS,SAChB9Q,QAAQ0S,IAChCF,EAAoBxR,KAAI,SAAA2R,GAAQ,OAAIC,EAAM5K,EAAU,uBAAwB,CAAC2K,GAAU,GAAO,KAC/F,OAFgB,OAAXhF,EAAc,EAAH,uBAGVA,GAAW,6CACnB,sBAED,SAAStM,EAASwP,GAChB,YAAkBvM,IAAduM,GAAyC,OAAdA,EAA2BA,EACnDhP,OAAOC,SAAS+O,EAAW,GACpC,CAQA,SAASC,EAASC,GAChB,YAAYzM,IAARyM,GAA6B,OAARA,EAAqBA,EAEvC,KADWA,EAAIC,SAAS,GAEjC,CAEA,SAAS4B,EAAM5K,EAAU7B,EAAQkD,GAC/B,OAAO,IAAIrJ,SAAQ,SAACC,EAASsL,GAC3BvD,EAAS6K,UAAU,CAAEvN,GAAI,EAAGwN,QAAS,MAAO3M,SAAQkD,WAAU,SAACzF,EAAKuB,GAClE,GAAIvB,EAAK,OAAO2H,EAAO3H,GACvB3D,EAAQkF,EAAIiB,OACd,GACF,GACF,CA1CArE,EAAOC,QAA2B,SAED,GAAD,+B,8HCF1B8G,EAAOjK,EAAQ,KACfM,EAAmBN,EAAQ,MAE3BC,EAAM,IAENiU,EAAmB,2CAEvB,aAAwB,MAAX3T,EAAO,UAAH,6CAAG,CAAC,EAEnB,GAFoB,WAEfA,EAAK4I,SAAU,MAAM,IAAIvD,MAAM,gDACpC,IAAMuO,EAAkB5T,EAAK4T,iBAAmB,GAAKlU,EAC/CmU,EAAe7T,EAAK6T,cAAgBD,EAAkB,GACtDE,OAAmD5O,IAA7BlF,EAAK8T,qBAAoC9T,EAAK8T,oBACpEC,EAAmB/T,EAAK+T,mBAAoB,EAUT,OARzC,cAAM/Q,OAAOmH,OAAO,CAClBjK,mBAAoB0T,GACnB5T,KAEEgU,UAAYhU,EAAK4I,SACtB,EAAKqL,iBAAmBL,EACxB,EAAKM,cAAgBL,EACrB,EAAKM,qBAAuBL,EAC5B,EAAKM,kBAAoBL,EAAgB,CAC3C,CAiDC,OA3CD,mEACA,8FACQpT,KAAK0T,qBAAoB,uBAClB1T,KAAK2T,iBAAgB,wFACnC,kDAJD,IAQA,oBAEA,WAAU,WACR3T,KAAK4T,eAAeC,OAAM,SAAAhQ,GAAG,OAAI,EAAKpC,KAAK,QAASoC,EAAI,GAC1D,GAAC,uDAED,wFACS7D,KAAKN,WAAY,CAAF,yCAEZM,KAAK0T,qBAAoB,uBACzBxD,EAAQlQ,KAAKsT,kBAAmBtT,KAAKwT,sBAAqB,uDAE1DM,EAAS,IAAIpP,MAAM,wFAAD,OAAyF,KAAImN,QACrH,IACE7R,KAAKyB,KAAK,QAASqS,EAGrB,CAFE,MAAOC,GACPC,QAAQxP,MAAMsP,EAChB,CAAC,iBACK5D,EAAQlQ,KAAKuT,eAAgBvT,KAAKwT,sBAAqB,gFAGlE,kDAjBA,IAiBA,6DAED,oGAE4BxT,KAAKiU,oBAAmB,OAA5C7T,EAAc,EAAH,KACjBJ,KAAKkU,oBAAoB9T,GAAY,gDACtC,kDANA,IAMA,4DAED,6FAEkD,OAD1C+E,EAAM,CAAE4N,QAAS,MAAOxN,GAAI,EAAGa,OAAQ,kBAAmBkD,OAAQ,IACpEtJ,KAAKyT,oBAAmBtO,EAAIgP,WAAY,GAAI,SAC9BpL,GAAK,SAACuB,GAAE,OAAK,EAAK+I,UAAUP,UAAU3N,EAAKmF,EAAG,GAA9CvB,GAAiD,OAA1D,KAAH3D,EAAM,EAAH,MACDZ,MAAO,CAAF,qBAAQ,IAAIE,MAAM,4DAAD,OAA6DU,EAAIZ,QAAQ,gCAChGY,EAAIiB,QAAM,gDAClB,kDARA,MAQA,EApEsB,CAASjH,GA0ElC,SAAS8Q,EAASkE,EAAUzS,GAC1B,OAAO,IAAI1B,SAAQ,SAAAC,GACjB,IAAMmU,EAAY3S,WAAWxB,EAASkU,GAElCC,EAAU1S,OAASA,GACrB0S,EAAU1S,OAEd,GACF,CAVAK,EAAOC,QAAU+Q,C,mCC3EjB,IAAMhI,EAAY,SAACC,EAAI5L,GAAI,OAAK,WAI/B,IAJ2C,WACrCiM,EAAIjM,EAAKkM,cACT9H,EAAO,IAAIwB,MAAMhB,UAAUC,QAExBF,EAAI,EAAGA,EAAIC,UAAUC,OAAQF,IACrCP,EAAKO,GAAKC,UAAUD,GAGrB,OAAO,IAAIsH,GAAE,SAACpL,EAASsL,GAClBnM,EAAKqM,WACRjI,EAAKU,MAAK,SAAUN,EAAKwC,GACxB,GAAIhH,EAAKoM,UAAW,CAGnB,IAFA,IAAM6I,EAAU,IAAIrP,MAAMhB,UAAUC,OAAS,GAEpCF,EAAI,EAAGA,EAAIC,UAAUC,OAAQF,IACrCsQ,EAAQtQ,EAAI,GAAKC,UAAUD,GAGxBH,GACHyQ,EAAQC,QAAQ1Q,GAChB2H,EAAO8I,IAEPpU,EAAQoU,EAEV,MAAWzQ,EACV2H,EAAO3H,GAEP3D,EAAQmG,EAEV,IAEA5C,EAAKU,MAAK,SAAUkC,GACnB,GAAIhH,EAAKoM,UAAW,CAGnB,IAFA,IAAM6I,EAAU,IAAIrP,MAAMhB,UAAUC,OAAS,GAEpCF,EAAI,EAAGA,EAAIC,UAAUC,OAAQF,IACrCsQ,EAAQtQ,GAAKC,UAAUD,GAGxB9D,EAAQoU,EACT,MACCpU,EAAQmG,EAEV,IAGD4E,EAAG3H,MAAM,EAAMG,EAChB,GACD,CAAC,EAEDzB,EAAOC,QAAU,SAACuS,EAAKnV,GACtBA,EAAOgD,OAAOmH,OAAO,CACpBwC,QAAS,CAAC,oBACVN,YAAY,EACZH,cAAetL,SACbZ,GAEH,IAKIoV,EALEvK,EAAS,SAAAwC,GACd,IAAMC,EAAQ,SAAAC,GAAO,MAAuB,kBAAZA,EAAuBF,IAAQE,EAAUA,EAAQC,KAAKH,EAAI,EAC1F,OAAOrN,EAAK+N,QAAU/N,EAAK+N,QAAQC,KAAKV,IAAUtN,EAAK2M,QAAQqB,KAAKV,EACrE,EAeA,IAAK,IAAMD,KAXV+H,EADkB,oBAARD,EACJ,WACL,OAAInV,EAAKmN,YACDgI,EAAIlR,MAAMtD,KAAMiE,WAGjB+G,EAAUwJ,EAAKnV,GAAMiE,MAAMtD,KAAMiE,UACzC,EAEM5B,OAAOqS,OAAOrS,OAAOH,eAAesS,IAGzBA,EAAK,CACtB,IAAMG,EAAIH,EAAI9H,GACd+H,EAAI/H,GAAoB,oBAANiI,GAAoBzK,EAAOwC,GAAO1B,EAAU2J,EAAGtV,GAAQsV,CAC1E,CAEA,OAAOF,CACR,C,sBCnFA,IAAIG,EAAgB,EAAQ,MAC5B,SAASC,IAcP,MAbuB,qBAAZzR,SAA2BA,QAAQmD,KAC5CvE,EAAOC,QAAU4S,EAAOzR,QAAQmD,IAAI3G,OAAQoC,EAAOC,QAAQQ,YAAa,EAAMT,EAAOC,QAAiB,QAAID,EAAOC,UAEjHD,EAAOC,QAAU4S,EAAO,SAActR,EAAQnB,EAAUoB,GACtD,IAAIsR,EAAOF,EAAcrR,EAAQnB,GACjC,GAAK0S,EAAL,CACA,IAAIhI,EAAOzK,OAAO0K,yBAAyB+H,EAAM1S,GACjD,OAAI0K,EAAKvG,IACAuG,EAAKvG,IAAI/D,KAAKyB,UAAUC,OAAS,EAAIX,EAASC,GAEhDsJ,EAAKqC,KALK,CAMnB,EAAGnN,EAAOC,QAAQQ,YAAa,EAAMT,EAAOC,QAAiB,QAAID,EAAOC,SAEnE4S,EAAKvR,MAAMtD,KAAMiE,UAC1B,CACAjC,EAAOC,QAAU4S,EAAM7S,EAAOC,QAAQQ,YAAa,EAAMT,EAAOC,QAAiB,QAAID,EAAOC,O,sBCjB5F,IAAM8S,EAASjW,EAAQ,KACjBkW,EAAiBlW,EAAQ,KAARA,GAKvB,SAASgK,EAASb,GACHjI,KACRiV,gBAAkBhN,CACzB,CAiEA,SAASiN,EAAcC,GACrB,OAAO,WACL,IACI1R,EAAO,GAAG2R,MAAM5S,KAAKyB,WACrBqG,EAAK7G,EAAK4R,MAFDrV,KAGR8S,UAAU,CACb1M,OAAQ+O,EACR7L,OAAQ7F,GACP6G,EACL,CACF,CAEA,SAASgL,EAA8BC,EAAUJ,GAC/C,OAAO,WACL,IACI1R,EAAO,GAAG2R,MAAM5S,KAAKyB,WACrBqG,EAAK7G,EAAK4R,MAEV5R,EAAKS,OAASqR,GAAU9R,EAAKU,KAAK,UAJzBnE,KAKR8S,UAAU,CACb1M,OAAQ+O,EACR7L,OAAQ7F,GACP6G,EACL,CACF,CA/FAtI,EAAOC,QAAU6G,EAajBA,EAASxG,UAAUkT,WAAsCF,EAA8B,EAAG,kBAC1FxM,EAASxG,UAAUmT,QAAsCH,EAA8B,EAAG,eAC1FxM,EAASxG,UAAUoT,oBAAsCJ,EAA8B,EAAG,2BAC1FxM,EAASxG,UAAUqT,aAAsCL,EAA8B,EAAG,oBAC1FxM,EAASxG,UAAUE,KAAsC8S,EAA8B,EAAG,YAE1FxM,EAASxG,UAAUsT,gBAAsCV,EAAc,uBACvEpM,EAASxG,UAAUuT,QAAsCX,EAAc,eACvEpM,EAASxG,UAAUwT,SAAsCZ,EAAc,gBACvEpM,EAASxG,UAAUyT,OAAsCb,EAAc,cACvEpM,EAASxG,UAAU0T,SAAsCd,EAAc,gBACvEpM,EAASxG,UAAU2T,SAAsCf,EAAc,gBACvEpM,EAASxG,UAAU4T,SAAsChB,EAAc,gBACvEpM,EAASxG,UAAUkI,YAAsC0K,EAAc,mBACvEpM,EAASxG,UAAU6T,+BAAsCjB,EAAc,sCACvEpM,EAASxG,UAAU8T,iCAAsClB,EAAc,wCACvEpM,EAASxG,UAAU+T,yBAAsCnB,EAAc,gCACvEpM,EAASxG,UAAUgU,2BAAsCpB,EAAc,kCACvEpM,EAASxG,UAAUiU,KAAsCrB,EAAc,YACvEpM,EAASxG,UAAUkU,gBAAsCtB,EAAc,uBACvEpM,EAASxG,UAAUmU,mBAAsCvB,EAAc,0BACvEpM,EAASxG,UAAUoU,YAAsCxB,EAAc,mBACvEpM,EAASxG,UAAUqU,eAAsCzB,EAAc,sBACvEpM,EAASxG,UAAUsU,iBAAsC1B,EAAc,wBACvEpM,EAASxG,UAAUuU,qBAAsC3B,EAAc,4BACvEpM,EAASxG,UAAUwU,kCAAsC5B,EAAc,yCACvEpM,EAASxG,UAAUyU,oCAAsC7B,EAAc,2CACvEpM,EAASxG,UAAU0U,sBAAsC9B,EAAc,6BACvEpM,EAASxG,UAAU2U,4BAAsC/B,EAAc,mCACvEpM,EAASxG,UAAU4U,8BAAsChC,EAAc,qCACvEpM,EAASxG,UAAU6U,aAAsCjC,EAAc,oBACvEpM,EAASxG,UAAU8U,WAAsClC,EAAc,kBACvEpM,EAASxG,UAAU+U,gBAAsCnC,EAAc,uBACvEpM,EAASxG,UAAUgV,eAAsCpC,EAAc,sBACvEpM,EAASxG,UAAUiV,UAAsCrC,EAAc,iBACvEpM,EAASxG,UAAUkV,eAAsCtC,EAAc,sBACvEpM,EAASxG,UAAUmV,4BAAsCvC,EAAc,mCACvEpM,EAASxG,UAAUoV,gBAAsCxC,EAAc,uBACvEpM,EAASxG,UAAUqV,iBAAsCzC,EAAc,wBACvEpM,EAASxG,UAAUsV,cAAsC1C,EAAc,qBACvEpM,EAASxG,UAAUiI,QAAsC2K,EAAc,eACvEpM,EAASxG,UAAUuV,QAAsC3C,EAAc,eACvEpM,EAASxG,UAAUwV,WAAsC5C,EAAc,kBACvEpM,EAASxG,UAAUyV,eAAsC7C,EAAc,sBAIvEpM,EAASxG,UAAUwQ,UAAY,SAASzT,EAAMiL,GAC5C,IAoCqBtD,EApCRhH,KACRiV,gBAAgBnC,WAmCA9L,EAnCwB3H,EAoCtC0V,EAAO,CAEZxP,GAAIyP,IACJjC,QAAS,MACTzJ,OAAQ,IAEPtC,KA1CiD,SAASnD,EAAKmU,GAEhE,IADKnU,GAAOmU,EAASxT,QAAOX,EAAM,IAAIa,MAAM,0BAA0BsT,EAASxT,MAAMG,UACjFd,EAAK,OAAOyG,EAAGzG,GACnByG,EAAG,KAAM0N,EAAS3R,OACpB,GACF,C,4DCtEMyJ,EAAQhR,EAAQ,MAAegR,MAC7BmI,EAA0BnZ,EAAQ,KAAlCmZ,sBACFC,EAA0BpZ,EAAQ,KAClCuK,EAAYvK,EAAQ,MACpB6O,EAAc7O,EAAQ,MACtBkP,EAAWlP,EAAQ,MACzB,EAA+BA,EAAQ,KAA/BiS,EAAQ,EAARA,SAAUzP,EAAQ,EAARA,SAsLlB,SAAS6W,EAA2BC,GAClC,OAAOC,EAAoB,YAAC,kHACLD,EAAc,gBAAS,OACV,OAD5BlO,EAAS,EAAH,KACN7D,EAAS0K,EAAS7G,EAAO3E,IAAG,kBAC3Bc,GAAM,2CAEjB,CAGA,SAASgS,EAAqBC,GAC5B,OAAOL,EAAqB,6BAAC,WAAO9S,EAAKC,GAAG,uFACrBkT,EAAQhV,MAAM,KAAM6B,EAAImE,QAAO,OAA9CjD,EAAS,EAAH,KACZjB,EAAIiB,OAASA,EAAM,2CACpB,qDAH2B,GAI9B,CAeA,SAASkS,EAAU/D,EAAKvJ,GACtB,IAAMuN,EAAS,GACf,IAAK,IAAI9L,KAAO8H,EACdgE,EAAOrU,KAAKqQ,EAAI9H,IAElB,OAAO8L,CACT,CAvNAxW,EAAOC,QAEP,SAAmC,GAA4B,IAA1BwW,EAAY,EAAZA,aAAcxQ,EAAQ,EAARA,SAG7CyQ,EAAc,EACdC,EAAU,CAAC,EAETC,EAAQ,IAAI9I,EACZ+I,EA2LR,SAAgC,GAAW,IAATD,EAAK,EAALA,MAChC,OAAO,SAAChQ,GACN,oCAAO,WAAOzD,EAAKC,EAAKC,EAAMO,GAAG,iFAILgT,EAAMpK,UAAS,QAAnCsK,EAAc,EAAH,QAEjBlQ,EAAWzD,EAAKC,EAAKC,EAAMO,GAAI,2CAChC,yDAPD,EAQF,CACF,CAtMsBmT,CAAuB,CAAEH,UAEvChQ,EAAasP,EAAwB,CAEzCc,cAAiCH,EAAYV,EAA2Bc,IACxEC,mBAAiCL,EAAYV,EAA2BX,IACxE2B,gCAAiCN,EAAYV,EAA2BV,IAExE2B,oBAAiCP,EAAYR,EAAqBgB,IAElEC,qBAAiCT,EAAYR,EAAqBV,IAClE4B,kBAAiCV,EAAYR,EAAqBT,MAI9D4B,EAAa,6BAAG,yFAA2B,GAAlBhY,EAAQ,EAARA,SAAUJ,EAAQ,EAARA,SAChB,IAAnBuX,EAAQzU,OAAY,iEAEE0U,EAAMpK,UAAS,OAAxB,OAAXsK,EAAc,EAAH,uBAGT7Y,QAAQ0S,IAAI4F,EAAUI,GAAS1X,IAAG,6BAAC,WAAOiJ,GAAM,0FAE7CA,EAAOuP,OAAO,CAAEjY,WAAUJ,aAAW,sDAG1C4S,QAAQxP,MAAM,EAAD,IAAK,wDAErB,mDAPuC,KAOrC,yDAGHwP,QAAQxP,MAAM,EAAD,IAAK,QAGpBsU,IAAa,0DACd,gBApBkB,sCAmCnB,OAZAlQ,EAAWqQ,aAAeA,EAC1BrQ,EAAW4O,eAAiBA,EAC5B5O,EAAW6O,4BAA8BA,EACzC7O,EAAW8O,gBAAkB2B,EAC7BzQ,EAAW+O,iBAAmBA,EAC9B/O,EAAWgP,cAAgBA,EAG3BhP,EAAW8Q,QAAU,YAoGpB,WAEiC,wBArGhCC,EACF,EAEO/Q,EAIP,SAEeqQ,EAAa,GAAD,4CAI1B,OAJ0B,cAA3B,WAA4B3P,GAAM,uEACkB,OAA5CY,EAAS,IAAIb,EAAU,CAAEpB,WAAUqB,WAAS,SACxBsQ,EAAc1P,GAAO,OAA9B,OAAG,EAAH,uBACVA,GAAM,4CACd,+BAEcsN,IAAc,4CAI5B,OAJ4B,cAA7B,oFAC8C,OAAtCtN,EAAS,IAAIyD,EAAY,CAAE1F,aAAW,SAClB2R,EAAc1P,GAAO,OAA9B,OAAG,EAAH,uBACVA,GAAM,4CACd,+BAEcuN,IAA2B,+BAQ1C,aAJC,OAID,cARA,oFAC2C,OAAnCvN,EAAS,IAAI8D,EAAS,CAAE/F,aAAW,SACf2R,EAAc1P,GAAO,OAA9B,OAAG,EAAH,uBACVA,GAAM,4CACd,+BAMcyN,EAAiB,GAAD,4CAQ9B,OAR8B,cAA/B,WAAgCkC,GAAc,2EAET,GAD7BnB,EAAcpX,EAASuY,GACvB3P,EAASyO,EAAQD,GACV,CAAF,qBACH,IAAIhU,MAAM,wBAAD,OAAyBgU,EAAW,MAAI,OAEd,OAArCpE,EAAUpK,EAAO4P,qBAAoB,kBACpCxF,GAAO,2CACf,iCAEcsD,EAAc,GAAD,+BAkB5B,aALC,OAKD,cAlBA,WAA6BiC,GAAc,yEAEN,GAD7BnB,EAAcpX,EAASuY,GACvB3P,EAASyO,EAAQD,GACV,CAAF,qBACH,IAAIhU,MAAM,wBAAD,OAAyBgU,EAAW,MAAI,OAOxD,MAJmB,QAAhBxO,EAAOnG,KACTuQ,QAAUpK,EAAO6P,gBAEjBzF,QAAU,GACX,kBACMA,SAAO,2CACf,iCAQc+E,EAAuB,GAAD,+BAcrC,aAJC,OAID,cAdA,WAAsCQ,GAAc,2EAKlD,GAHMnB,EAAcpX,EAASuY,GACvB3P,EAASyO,EAAQD,KACjBrS,EAAS2T,QAAQ9P,IAEX,CAAF,+BACFwN,EAAgBgB,GAAY,gCAE7BrS,GAAM,2CACd,iCAMcuT,EAAc,GAAD,4CAa3B,OAb2B,cAA5B,WAA6B1P,GAAM,2EAEjC,OADM+P,EAAkB1B,EAAUI,GAASzU,OAC3C,SAC2BuU,EAAa9E,iBAAgB,OAAtC,OAAZtS,EAAe,EAAH,cACZ6I,EAAOgQ,WAAW,CAAE7Y,iBAAe,OAOkB,OAN3DqX,IACAC,EAAQD,GAAexO,EACvBA,EAAO3E,GAAKmT,EACZxO,EAAOiQ,MAAQpJ,EAAS2H,GAElB0B,EAAiB7B,EAAUI,GAASzU,OAC1CmW,EAAuB,CAAEJ,kBAAiBG,mBAAiB,kBACpD1B,GAAW,6CACnB,+BAEchB,EAAgB,GAAD,4CAM7B,OAN6B,cAA9B,WAA+BgB,GAAW,yEAClCuB,EAAkB1B,EAAUI,GAASzU,cACpCyU,EAAQD,GAET0B,EAAiB7B,EAAUI,GAASzU,OAC1CmW,EAAuB,CAAEJ,kBAAiBG,mBAAiB,2CAC5D,wBAEiC,aAKjC,OALiC,cAAlC,oFACQH,EAAkB1B,EAAUI,GAASzU,OAC3CyU,EAAU,CAAC,EAEX0B,EAAuB,CAAEJ,kBAAiBG,eAAgB,IAAI,4CAC/D,sBAED,SAASC,EAAuB,GAAqC,IAAnCJ,EAAe,EAAfA,gBAAiBG,EAAc,EAAdA,eAEzB,IAApBH,GAAyBG,EAAiB,EAC5C3B,EAAalY,GAAG,OAAQiZ,GAItBS,EAAkB,GAAwB,IAAnBG,GACzB3B,EAAanY,eAAe,OAAQkZ,EAGxC,CAEF,C,6ZxBzLAc,aACAA,aACAA,aACAA,YACAA,YACAA,Y,yGyBHA,IAAMC,EAAM,WACR3X,EAAYE,KAAKC,MAAMD,KAAKE,SAAWuX,GAE3CtY,cAAA,WAEE,OADAW,GAAaA,EAAY,GAAK2X,CAEhC,C,oUCRA,gBACA,UA2FaC,EAAc,8BAGzB,mBAEwB,OAFxB,WACE,gBACKC,YAAc,GAAG,CACxB,CA8XC,OA5XD,uBAKA,SAAW7R,GACT,KAAK6R,YAAYtW,KAAKyE,EACxB,GAAC,oBA2CD,SAAOzD,EAAcmF,GACnB,GAAIA,GAAoB,oBAAPA,EACf,MAAM,IAAI5F,MAAM,8CAGlB,OAAIO,MAAMiC,QAAQ/B,GACZmF,EACK,KAAKoQ,aAAavV,EAAKmF,GAEzB,KAAKoQ,aAAavV,GAGvBmF,EACK,KAAKqQ,QAAQxV,EAAgCmF,GAE/C,KAAKsQ,eAAezV,EAC7B,GAEA,0BAMA,WAAY,WACV,oCAAO,WAAOA,EAAKC,EAAKC,EAAMO,GAAG,wGAMnB4U,EAAcK,kBAAkB1V,EAAKC,EAAK,EAAKqV,aAAY,OADrD,GACqD,kBAHnEK,EAAe,KACfC,EAAU,KACVC,EAAc,MAGZD,EAAU,kCACNP,EAAcS,mBAAmBD,GAAe,iCAC/CpV,EAAIkV,IAA8C,iCAGpDzV,EAAI,6BAAC,WAAO6V,GAAe,0FAExBV,EAAcS,mBAAmBD,GAAe,+EAE/CE,EAAe,OAAO,gCAExBA,KAAiB,wDACzB,mDAPU,KAOT,2DAEKtV,EAAG,OAAO,0DAEpB,yDAxBD,EAyBF,GAAC,uDAiBO,WACNuV,EACA7Q,GAAqE,gGAM3CrK,QAAQ0S,IAE9BwI,EAAKla,IAAI,KAAK2Z,eAAehb,KAAK,QACnC,OAHc,GAATwb,EAAS,QAMX9Q,EAAE,yCACGA,EAAG,KAAM8Q,IAAU,gCAErBA,GAAS,oCAEZ9Q,EAAE,0CACGA,EAAE,OAAO,4EAKrB,qDA1CA,IA4CD,4BAGQ,SACNnF,GAA4B,WAE5B,OAAO,IAAIlF,SAAQ,SAACC,GAClB,EAAKya,QAAQxV,GAAK,SAACkW,EAAMjW,GAGvBlF,EAAQkF,EACV,GACF,GACF,GAEA,kDAMQ,WACNkW,EACAhR,GAAgE,kFAG7DgR,IACDrW,MAAMiC,QAAQoU,IACO,kBAAdA,EAAsB,gBAM5B,OAJK9W,EAAQ,IAAI+W,mBAChBA,aAAWpU,IAAIE,eAAc,2DACuBiU,GACpD,CAAEE,QAASF,IACZ,kBACMhR,EAAG9F,EAAO,CAAEe,QAAIhB,EAAWwO,QAAS,MAAOvO,WAAQ,UAG5B,kBAArB8W,EAAUlV,OAAmB,gBAKrC,OAJK5B,EAAQ,IAAI+W,mBAChBA,aAAWpU,IAAIE,eAAc,yDACqBiU,EAAUlV,QAC5D,CAAEoV,QAASF,IACZ,kBACMhR,EAAG9F,EAAO,CAAEe,GAAI+V,EAAU/V,GAAIwN,QAAS,MAAOvO,WAAQ,OAQnB,OALtCW,EAAG,iBAAiCmW,GACpClW,EAAuC,CAC3CG,GAAIJ,EAAII,GACRwN,QAAS5N,EAAI4N,SAEXvO,EAAoC,KAAI,mBAGpC,KAAKiX,gBAAgBtW,EAAKC,GAAI,0DAIpCZ,EAAK,KAAU,QAShB,OANGA,WAEKY,EAAIiB,OACNjB,EAAIZ,QACPY,EAAIZ,MAAQ+W,iBAAe/W,KAE9B,kBAEM8F,EAAG9F,EAAOY,IAAgC,0DAClD,qDAxDD,IA0DA,0DAKQ,WACND,EACAC,GAAoC,+FAM1BoV,EAAcK,kBAAkB1V,EAAKC,EAAK,KAAKqV,aAAY,OAOrE,OAPqE,kBAHnEjW,EAAK,KACLuW,EAAU,KACVC,EAAc,KAKhBR,EAAckB,oBAAoBvW,EAAKC,EAAK2V,GAG5C,UACMP,EAAcS,mBAAmBD,GAAe,YAIlDxW,EAAK,uBACDA,EAAK,iDAEd,qDA5BD,KA8BA,6DAOQ,WACNW,EACAC,EACAoD,GAAsD,qFAQhDwS,EAA+C,GACjDxW,EAAQ,KACRuW,GAAa,EAEjB,IACyBvS,GAAe,yDAAnB,OAAVI,EAAU,kBACS4R,EAAcmB,eACxCxW,EACAC,EACAwD,EACAoS,GACD,QALiB,GAKjB,kBALAxW,EAAK,OAAEuW,EAAU,MAMJ,qNAIT,CAACvW,EAAOuW,EAAYC,EAAeY,YAAU,gEACrD,uDAnCD,IAqCA,4BAMQ,SACNzW,EACAC,EACAwD,EACAoS,GAEA,OAAO,IAAI/a,SAAQ,SAACC,GAClB,IAAM0F,EAAgC,SAAC/B,GACrC,IAAMW,EAAQX,GAAOuB,EAAIZ,MACrBA,IACFY,EAAIZ,MAAQ+W,iBAAe/W,IAG7BtE,EAAQ,CAACsE,GAAO,GAClB,EA6BA,IACEoE,EAAWzD,EAAKC,GA5BsB,SACtCyW,GAEIzW,EAAIZ,MACNoB,EAAIR,EAAIZ,QAEJqX,IAC2B,oBAAlBA,GACTjW,EACE,IAAI2V,mBACFA,aAAWpU,IAAIK,SACf,uFACsBqU,EAAa,2BAAmBC,EAClD3W,IAEJ,CAAEqW,QAASrW,KAIjB6V,EAAe7W,KAAK0X,IAItB3b,EAAQ,CAAC,MAAM,IAEnB,GAG6B0F,E,CAC3B,MAAOpB,GACPoB,EAAIpB,E,CAER,GACF,GAEA,6DAIQ,WACN2B,GAAsC,+EAEhBA,GAAQ,yGAAZ,OAAP3F,EAAO,iBACV,IAAIP,SAAQ,SAACC,EAASsL,GAC1BhL,GAAQ,SAACqD,GAAG,OAAMA,EAAM2H,EAAO3H,GAAO3D,GAAS,GACjD,IAAE,iUAEL,mDAZD,IAcA,iCAIQ,SACNiF,EACAC,EACA2V,GAEA,KAAM,WAAY3V,MAAU,UAAWA,GACrC,MAAM,IAAImW,mBACRA,aAAWpU,IAAIK,SAAQ,uEACyCsU,EAC9D3W,IAEF,CAAEqW,QAASrW,IAGf,IAAK4V,EACH,MAAM,IAAIQ,mBACRA,aAAWpU,IAAIK,SAAQ,iDACmBsU,EAAQ3W,IAClD,CAAEqW,QAASrW,GAGjB,KAAC,EApYwB,CAAQ4W,WAuYnC,SAASD,EAAQN,GACf,OAAOQ,KAAKC,UAAUT,EAAS,KAAM,EACvC,CAzYAvZ,iB,oBC5FAD,EAAOC,QAAUga,EACjBA,EAAU3J,QAAU2J,EACpBA,EAAUC,OAASC,EACnBF,EAAUG,gBAAkBD,EAE5B,IAAIE,EAAqB,QACrBC,EAAwB,aAExBxX,EAAM,GACNyX,EAAgB,GAEpB,SAASC,IACP,MAAO,CACLC,WAAY3a,OAAOa,iBACnB+Z,WAAY5a,OAAOa,iBAEvB,CAGA,SAASsZ,EAAWzH,EAAKmI,EAAUC,EAAQ1R,GAMzC,IAAI9F,EALmB,qBAAZ8F,IACTA,EAAUsR,KAGZK,EAAOrI,EAAK,GAAI,EAAG,QAAIjQ,EAAW,EAAG2G,GAErC,IAEI9F,EAD2B,IAAzBmX,EAAcrY,OACV8X,KAAKC,UAAUzH,EAAKmI,EAAUC,GAE9BZ,KAAKC,UAAUzH,EAAKsI,EAAoBH,GAAWC,EAa7D,CAXE,MAAOzK,GACP,OAAO6J,KAAKC,UAAU,sEACxB,CAAE,QACA,KAAsB,IAAfnX,EAAIZ,QAAc,CACvB,IAAI6Y,EAAOjY,EAAIuQ,MACK,IAAhB0H,EAAK7Y,OACP7B,OAAO2a,eAAeD,EAAK,GAAIA,EAAK,GAAIA,EAAK,IAE7CA,EAAK,GAAGA,EAAK,IAAMA,EAAK,EAE5B,CACF,CACA,OAAO3X,CACT,CAEA,SAAS6X,EAAYC,EAASC,EAAKC,EAAGC,GACpC,IAAIC,EAAqBjb,OAAO0K,yBAAyBsQ,EAAQD,QAClC7Y,IAA3B+Y,EAAmB/W,IACjB+W,EAAmBpQ,cACrB7K,OAAO2a,eAAeK,EAAQD,EAAG,CAAEjO,MAAO+N,IAC1CpY,EAAIX,KAAK,CAACkZ,EAAQD,EAAGD,EAAKG,KAE1Bf,EAAcpY,KAAK,CAACgZ,EAAKC,EAAGF,KAG9BG,EAAOD,GAAKF,EACZpY,EAAIX,KAAK,CAACkZ,EAAQD,EAAGD,IAEzB,CAEA,SAASN,EAAQM,EAAKC,EAAGG,EAAW1L,EAAOwL,EAAQG,EAAOtS,GAExD,IAAIlH,EACJ,GAFAwZ,GAAS,EAEU,kBAARL,GAA4B,OAARA,EAAc,CAC3C,IAAKnZ,EAAI,EAAGA,EAAI6N,EAAM3N,OAAQF,IAC5B,GAAI6N,EAAM7N,KAAOmZ,EAEf,YADAF,EAAWX,EAAuBa,EAAKC,EAAGC,GAK9C,GACgC,qBAAvBnS,EAAQuR,YACfe,EAAQtS,EAAQuR,WAGhB,YADAQ,EAAWZ,EAAoBc,EAAKC,EAAGC,GAIzC,GACgC,qBAAvBnS,EAAQwR,YACfa,EAAY,EAAIrS,EAAQwR,WAGxB,YADAO,EAAWZ,EAAoBc,EAAKC,EAAGC,GAMzC,GAFAxL,EAAM1N,KAAKgZ,GAEPlY,MAAMiC,QAAQiW,GAChB,IAAKnZ,EAAI,EAAGA,EAAImZ,EAAIjZ,OAAQF,IAC1B6Y,EAAOM,EAAInZ,GAAIA,EAAGA,EAAG6N,EAAOsL,EAAKK,EAAOtS,OAErC,CACL,IAAIuS,EAAOpb,OAAOob,KAAKN,GACvB,IAAKnZ,EAAI,EAAGA,EAAIyZ,EAAKvZ,OAAQF,IAAK,CAChC,IAAI0I,EAAM+Q,EAAKzZ,GACf6Y,EAAOM,EAAIzQ,GAAMA,EAAK1I,EAAG6N,EAAOsL,EAAKK,EAAOtS,EAC9C,CACF,CACA2G,EAAMwD,KACR,CACF,CAGA,SAASqI,EAAiBC,EAAGC,GAC3B,OAAID,EAAIC,GACE,EAEND,EAAIC,EACC,EAEF,CACT,CAEA,SAASzB,EAAwB3H,EAAKmI,EAAUC,EAAQ1R,GAC/B,qBAAZA,IACTA,EAAUsR,KAGZ,IACIpX,EADAyY,EAAMC,EAAoBtJ,EAAK,GAAI,EAAG,QAAIjQ,EAAW,EAAG2G,IAAYsJ,EAExE,IAEIpP,EAD2B,IAAzBmX,EAAcrY,OACV8X,KAAKC,UAAU4B,EAAKlB,EAAUC,GAE9BZ,KAAKC,UAAU4B,EAAKf,EAAoBH,GAAWC,EAc7D,CAZE,MAAOzK,GACP,OAAO6J,KAAKC,UAAU,sEACxB,CAAE,QAEA,KAAsB,IAAfnX,EAAIZ,QAAc,CACvB,IAAI6Y,EAAOjY,EAAIuQ,MACK,IAAhB0H,EAAK7Y,OACP7B,OAAO2a,eAAeD,EAAK,GAAIA,EAAK,GAAIA,EAAK,IAE7CA,EAAK,GAAGA,EAAK,IAAMA,EAAK,EAE5B,CACF,CACA,OAAO3X,CACT,CAEA,SAAS0Y,EAAqBX,EAAKC,EAAGG,EAAW1L,EAAOwL,EAAQG,EAAOtS,GAErE,IAAIlH,EACJ,GAFAwZ,GAAS,EAEU,kBAARL,GAA4B,OAARA,EAAc,CAC3C,IAAKnZ,EAAI,EAAGA,EAAI6N,EAAM3N,OAAQF,IAC5B,GAAI6N,EAAM7N,KAAOmZ,EAEf,YADAF,EAAWX,EAAuBa,EAAKC,EAAGC,GAI9C,IACE,GAA0B,oBAAfF,EAAIY,OACb,MAIJ,CAFE,MAAO5L,GACP,MACF,CAEA,GACgC,qBAAvBjH,EAAQuR,YACfe,EAAQtS,EAAQuR,WAGhB,YADAQ,EAAWZ,EAAoBc,EAAKC,EAAGC,GAIzC,GACgC,qBAAvBnS,EAAQwR,YACfa,EAAY,EAAIrS,EAAQwR,WAGxB,YADAO,EAAWZ,EAAoBc,EAAKC,EAAGC,GAMzC,GAFAxL,EAAM1N,KAAKgZ,GAEPlY,MAAMiC,QAAQiW,GAChB,IAAKnZ,EAAI,EAAGA,EAAImZ,EAAIjZ,OAAQF,IAC1B8Z,EAAoBX,EAAInZ,GAAIA,EAAGA,EAAG6N,EAAOsL,EAAKK,EAAOtS,OAElD,CAEL,IAAI2S,EAAM,CAAC,EACPJ,EAAOpb,OAAOob,KAAKN,GAAKxM,KAAK+M,GACjC,IAAK1Z,EAAI,EAAGA,EAAIyZ,EAAKvZ,OAAQF,IAAK,CAChC,IAAI0I,EAAM+Q,EAAKzZ,GACf8Z,EAAoBX,EAAIzQ,GAAMA,EAAK1I,EAAG6N,EAAOsL,EAAKK,EAAOtS,GACzD2S,EAAInR,GAAOyQ,EAAIzQ,EACjB,CACA,GAAsB,qBAAX2Q,EAIT,OAAOQ,EAHP/Y,EAAIX,KAAK,CAACkZ,EAAQD,EAAGD,IACrBE,EAAOD,GAAKS,CAIhB,CACAhM,EAAMwD,KACR,CACF,CAIA,SAASyH,EAAqBH,GAO5B,OANAA,EACsB,qBAAbA,EACHA,EACA,SAAUS,EAAGY,GACb,OAAOA,CACT,EACG,SAAUtR,EAAKyQ,GACpB,GAAIZ,EAAcrY,OAAS,EACzB,IAAK,IAAIF,EAAI,EAAGA,EAAIuY,EAAcrY,OAAQF,IAAK,CAC7C,IAAI+Y,EAAOR,EAAcvY,GACzB,GAAI+Y,EAAK,KAAOrQ,GAAOqQ,EAAK,KAAOI,EAAK,CACtCA,EAAMJ,EAAK,GACXR,EAAc0B,OAAOja,EAAG,GACxB,KACF,CACF,CAEF,OAAO2Y,EAASna,KAAKxC,KAAM0M,EAAKyQ,EAClC,CACF,C,+KCpOA,aACA,SAEMe,EAAsBvX,aAAWQ,IAAIK,SACrC2W,EAAmB,8DACnBC,EAA6C,CACjDvX,KAAMqX,EACNvZ,QAAS0Z,EAAmBH,IAW9B,SAAgBG,EACdxX,GAC0C,IAA1CyX,yDAA0BH,EAE1B,GAAIrc,OAAO4F,UAAUb,GAAO,CAC1B,IAAM0X,EAAa1X,EAAKoK,WAExB,GAAIuN,EAAO7X,cAAa4X,GACtB,OAAO5X,cAAY4X,GAA6B5Z,QAElD,GAAI8Z,EAAqB5X,GACvB,OAAO5E,+B,CAGX,OAAOqc,CACT,CAMA,SAAgBI,EAAY7X,GAC1B,IAAK/E,OAAO4F,UAAUb,GACpB,OAAO,EAGT,IAAM0X,EAAa1X,EAAKoK,WACxB,QAAItK,cAAY4X,MAIZE,EAAqB5X,EAI3B,CA8EA,SAAS4X,EAAqB5X,GAC5B,OAAOA,IAAS,OAASA,IAAS,IACpC,CAEA,SAAS8X,EAAoBna,GAC3B,OAAIA,GAA0B,kBAAVA,IAAuBS,MAAMiC,QAAQ1C,GAChDnC,OAAOmH,OAAO,GAAIhF,GAEpBA,CACT,CAEA,SAASga,EAAOhK,EAA8B9H,GAC5C,OAAOrK,OAAOC,UAAUC,eAAeC,KAAKgS,EAAK9H,EACnD,CAtIazK,gCAAgC,4BAQ7CA,uBAqBAA,gBAsBAA,iBAAA,SACEuC,GAIM,I,IAAA,yDAAF,GAAE,IAFJoa,qBAAa,MAAGR,EAAc,MAC9BS,0BAAkB,OAAQ,EAI5B,IACGD,IACA9c,OAAO4F,UAAUkX,EAAc/X,OACC,kBAA1B+X,EAAcja,QAErB,MAAM,IAAID,MACR,4EAIJ,GAAIF,aAAiBgC,mBACnB,OAAOhC,EAAMuN,YAGf,IAAMH,EAAkD,GAExD,GACEpN,GACiB,kBAAVA,IACNS,MAAMiC,QAAQ1C,IACfga,EAAOha,EAAkC,SACzCka,EAAala,EAAqCqC,MAClD,CACA,IAAMiY,EAASta,EACfoN,EAAW/K,KAAOiY,EAAOjY,KAErBiY,EAAOna,SAAqC,kBAAnBma,EAAOna,SAClCiN,EAAWjN,QAAUma,EAAOna,QAExB6Z,EAAOM,EAAQ,UACjBlN,EAAW5K,KAAO8X,EAAO9X,QAG3B4K,EAAWjN,QAAU0Z,EAClBzM,EAA0C/K,MAG7C+K,EAAW5K,KAAO,CAAE+X,cAAeJ,EAAoBna,I,KAEpD,CACLoN,EAAW/K,KAAO+X,EAAc/X,KAEhC,IAAMlC,EAAwB,QAAjB,EAAIH,SAAa,eAAEG,QAEhCiN,EAAWjN,QACTA,GAA8B,kBAAZA,EACdA,EACAia,EAAcja,QAEpBiN,EAAW5K,KAAO,CAAE+X,cAAeJ,EAAoBna,G,CAGzD,IAAMqN,EAAsB,QAAjB,EAAIrN,SAAa,eAAEqN,MAK9B,OAHIgN,GAAsBra,GAASqN,GAA0B,kBAAVA,IACjDD,EAAWC,MAAQA,GAEdD,CACT,C,sBC9HA5P,EAAOC,QAAUnD,EAAQ,K,4DCDnBD,EAAmBC,EAAQ,KAAgCwT,QAC3D0M,EAA2BlgB,EAAQ,KACjCmZ,EAA0BnZ,EAAQ,KAAlCmZ,sBACFgH,EAAyBngB,EAAQ,KACvC,EAA+CA,EAAQ,KAA/CyS,EAAiB,EAAjBA,kBAAmBrI,EAAe,EAAfA,gBACrBwE,EAAoB5O,EAAQ,KA8HlC,SAASogB,EAAepR,GACtB,MAAO,CACLC,KAAMD,EAAMC,KACZoR,WAAYrR,EAAMqR,WAClBC,WAAYtR,EAAMsR,WAClBC,MAAOvR,EAAMuR,MACbC,UAAWxR,EAAMwR,UACjBC,iBAAkBzR,EAAMyR,iBACxBC,aAAc1R,EAAM0R,aACpBC,UAAW3R,EAAM2R,UACjBC,WAAY5R,EAAM4R,WAClBC,OAAQ7R,EAAM6R,OACdC,SAAU9R,EAAM8R,SAChBC,QAAS/R,EAAM+R,QACfC,MAAOhS,EAAMgS,MACbC,QAASjS,EAAMiS,QACfC,UAAWlS,EAAMkS,UACjBC,UAAWnS,EAAMmS,UAErB,CA/IAje,EAAOC,QAGP,SAAsC,GAA4B,IAA1BwW,EAAY,EAAZA,aAAcxQ,EAAQ,EAARA,SAE9CiY,EAAgB,CAAC,EACjBC,EAAgBlB,EAAuB,CAAExG,eAAcxQ,aAGzDmY,GAAc,EAGZ/b,EAAS,IAAIxF,EACb+J,EAAaoW,EAAyB,CAC1CqB,cAAepI,GAIY,SAEJ,EAAD,qCALtBqI,gBAAiBrI,GAmElB,SAE0B,EAAD,uCAlE1B,OADArP,EAAW8Q,QAiGX,WAEE,IAAK,IAAMnU,KADXlB,EAAOkc,qBACUL,EACfA,EAAc3a,GAAImU,iBACXwG,EAAc3a,GAEvB6a,GAAc,CAChB,EAvGO,CAAE/b,SAAQuE,cAEO,aA8DvB,OA9DuB,cAAxB,WAAyBzD,EAAKC,GAAG,cA8BtBob,EAsBAC,EAAmB,iEAF3B,GAEQA,EAAmB,YAAmB,IAAhBC,EAAK,EAALA,MAAOxW,EAAM,EAANA,OACpCA,EAAO3J,GAAG,UAAU,SAAA8F,GAAM,OAAIsa,EAAwBD,EAAOra,EAAO,IACpE,IAAMua,EAAM,CACV7c,KAAM8c,EACNnH,QAAS,WAAF,kBAAE,8FACMyG,EAAczI,gBAAgBxN,EAAOiQ,OAAM,mFACzD,kDAFQ,IAIX,OAAOyG,CACT,EA/BSJ,EAAiB,YAAY,IAATE,EAAK,EAALA,MACrBE,EAAM,CACV7c,KAAM8c,EACNnH,QAAS,WAAF,kBAAE,8EACPjB,EAAanY,eAAe,OAAQsgB,EAAInH,QAAO,2CAChD,kDAFQ,GAGTA,OAAQ,WAAF,kBAAE,6FAGqC,OAH5BjY,EAAQ,EAARA,SAAUJ,EAAQ,EAARA,SAEnBsI,EAAUtI,EACVqI,EAAYP,EAAgB1H,GAAS,SACnBkM,EAAkB,CAAEzF,WAAUwB,YAAWC,YAAU,OAArEoX,EAAY,EAAH,KACCA,EAAU7f,IAAIie,GACtBvW,SAAQ,SAACwG,GACfwR,EAAwBD,EAAOvR,EACjC,IAAE,2CACH,mDATO,IAaV,OADAsJ,EAAalY,GAAG,OAAQqgB,EAAInH,QACrBmH,CACT,GAhDIR,EAAa,CAAF,qBAAQ,IAAI1b,MACzB,4DACD,OAEKmc,EAAmB1b,EAAImE,OAAO,GAE9BoX,EAAQnP,EAAkB,IAEhC,KAEQsP,EAAgB,OACjB,aADiB,KACP,EAGV,SAHU,KAGJ,mBAFyB,OAAlCD,EAAMJ,EAAkB,CAAEE,UAAQ,6BAGA,OAA5BK,EAAe5b,EAAImE,OAAO,GAAE,UACb6W,EAAclH,aAAa8H,GAAa,QACjB,OADtC7W,EAAS,EAAH,KACZ0W,EAAMH,EAAoB,CAAEC,QAAOxW,WAAS,mCAGtC,IAAIxF,MAAM,wDAAD,OAAyDmc,EAAgB,MAAI,QAK9E,OAFlBX,EAAcQ,GAASE,EAEvBxb,EAAIiB,OAASqa,EAAK,+DAmCnB,wBAEyB,aAiBzB,OAjByB,cAA1B,WAA2Bvb,EAAKC,GAAG,6EAE7Bgb,EAAa,CAAF,qBAAQ,IAAI1b,MACzB,4DACD,OAID,GAFMa,EAAKJ,EAAImE,OAAO,GAChB0X,EAAed,EAAc3a,GAEhB,CAAF,eACG,OAAlBH,EAAIiB,QAAS,EAAK,0BAII,cAAjB6Z,EAAc3a,GAAG,UAClByb,EAAatH,UAAS,QAC5BtU,EAAIiB,QAAS,EAAI,6CAClB,sBAED,SAASsa,EAAwBM,EAAa9R,GAC5C9K,EAAO5C,KAAK,eAAgB,CAC1BsR,QAAS,MACT3M,OAAQ,mBACRkD,OAAQ,CACN0X,aAAcC,EACd5a,OAAQ8I,IAGd,CAUF,C,sBCjIA,IAAI+R,EAAmB,EAAQ,KAI/Blf,EAAOC,QAHP,SAA4B6C,GAC1B,GAAIG,MAAMiC,QAAQpC,GAAM,OAAOoc,EAAiBpc,EAClD,EACqC9C,EAAOC,QAAQQ,YAAa,EAAMT,EAAOC,QAAiB,QAAID,EAAOC,O,oBCD1GD,EAAOC,QAHP,SAA0Bkf,GACxB,GAAsB,qBAAXC,QAAmD,MAAzBD,EAAKC,OAAOC,WAA2C,MAAtBF,EAAK,cAAuB,OAAOlc,MAAMqc,KAAKH,EACtH,EACmCnf,EAAOC,QAAQQ,YAAa,EAAMT,EAAOC,QAAiB,QAAID,EAAOC,O,oBCAxGD,EAAOC,QAHP,WACE,MAAM,IAAIiK,UAAU,uIACtB,EACqClK,EAAOC,QAAQQ,YAAa,EAAMT,EAAOC,QAAiB,QAAID,EAAOC,O","file":"static/js/0.be808da3.chunk.js","sourcesContent":["const EthQuery = require('eth-query')\nconst pify = require('pify')\nconst SafeEventEmitter = require('safe-event-emitter')\n\nconst sec = 1000\n\nconst calculateSum = (accumulator, currentValue) => accumulator + currentValue\nconst blockTrackerEvents = ['sync', 'latest']\n\nclass BaseBlockTracker extends SafeEventEmitter {\n\n  //\n  // public\n  //\n\n  constructor (opts = {}) {\n    super()\n    // config\n    this._blockResetDuration = opts.blockResetDuration || 20 * sec\n    // state\n    this._blockResetTimeout\n    this._currentBlock = null\n    this._isRunning = false\n    // bind functions for internal use\n    this._onNewListener = this._onNewListener.bind(this)\n    this._onRemoveListener = this._onRemoveListener.bind(this)\n    this._resetCurrentBlock = this._resetCurrentBlock.bind(this)\n    // listen for handler changes\n    this._setupInternalEvents()\n  }\n\n  isRunning () {\n    return this._isRunning\n  }\n\n  getCurrentBlock () {\n    return this._currentBlock\n  }\n\n  async getLatestBlock () {\n    // return if available\n    if (this._currentBlock) return this._currentBlock\n    // wait for a new latest block\n    const latestBlock = await new Promise(resolve => this.once('latest', resolve))\n    // return newly set current block\n    return latestBlock\n  }\n\n  // dont allow module consumer to remove our internal event listeners\n  removeAllListeners (eventName) {\n    // perform default behavior, preserve fn arity\n    if (eventName) {\n      super.removeAllListeners(eventName)\n    } else {\n      super.removeAllListeners()\n    }\n    // re-add internal events\n    this._setupInternalEvents()\n    // trigger stop check just in case\n    this._onRemoveListener()\n  }\n\n  //\n  // to be implemented in subclass\n  //\n\n  _start () {\n    // default behavior is noop\n  }\n\n  _end () {\n    // default behavior is noop\n  }\n\n  //\n  // private\n  //\n\n  _setupInternalEvents () {\n    // first remove listeners for idempotence\n    this.removeListener('newListener', this._onNewListener)\n    this.removeListener('removeListener', this._onRemoveListener)\n    // then add them\n    this.on('newListener', this._onNewListener)\n    this.on('removeListener', this._onRemoveListener)\n  }\n\n  _onNewListener (eventName, handler) {\n    // `newListener` is called *before* the listener is added\n    if (!blockTrackerEvents.includes(eventName)) return\n    this._maybeStart()\n  }\n\n  _onRemoveListener (eventName, handler) {\n    // `removeListener` is called *after* the listener is removed\n    if (this._getBlockTrackerEventCount() > 0) return\n    this._maybeEnd()\n  }\n\n  _maybeStart () {\n    if (this._isRunning) return\n    this._isRunning = true\n    // cancel setting latest block to stale\n    this._cancelBlockResetTimeout()\n    this._start()\n  }\n\n  _maybeEnd () {\n    if (!this._isRunning) return\n    this._isRunning = false\n    this._setupBlockResetTimeout()\n    this._end()\n  }\n\n  _getBlockTrackerEventCount () {\n    return blockTrackerEvents\n      .map(eventName => this.listenerCount(eventName))\n      .reduce(calculateSum)\n  }\n\n  _newPotentialLatest (newBlock) {\n    const currentBlock = this._currentBlock\n    // only update if blok number is higher\n    if (currentBlock && (hexToInt(newBlock) <= hexToInt(currentBlock))) return\n    this._setCurrentBlock(newBlock)\n  }\n\n  _setCurrentBlock (newBlock) {\n    const oldBlock = this._currentBlock\n    this._currentBlock = newBlock\n    this.emit('latest', newBlock)\n    this.emit('sync', { oldBlock, newBlock })\n  }\n\n  _setupBlockResetTimeout () {\n    // clear any existing timeout\n    this._cancelBlockResetTimeout()\n    // clear latest block when stale\n    this._blockResetTimeout = setTimeout(this._resetCurrentBlock, this._blockResetDuration)\n    // nodejs - dont hold process open\n    if (this._blockResetTimeout.unref) {\n      this._blockResetTimeout.unref()\n    }\n  }\n\n  _cancelBlockResetTimeout () {\n    clearTimeout(this._blockResetTimeout)\n  }\n\n  _resetCurrentBlock () {\n    this._currentBlock = null\n  }\n\n}\n\nmodule.exports = BaseBlockTracker\n\nfunction hexToInt(hexInt) {\n  return Number.parseInt(hexInt, 16)\n}\n","var getPrototypeOf = require(\"./getPrototypeOf.js\");\nfunction _superPropBase(object, property) {\n  while (!Object.prototype.hasOwnProperty.call(object, property)) {\n    object = getPrototypeOf(object);\n    if (object === null) break;\n  }\n  return object;\n}\nmodule.exports = _superPropBase, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","module.exports = IdIterator\n\nfunction IdIterator(opts){\n  opts = opts || {}\n  var max = opts.max || Number.MAX_SAFE_INTEGER\n  var idCounter = typeof opts.start !== 'undefined' ? opts.start : Math.floor(Math.random() * max)\n\n  return function createRandomId () {\n    idCounter = idCounter % max\n    return idCounter++\n  }\n\n}","const util = require('util')\nconst EventEmitter = require('events/')\n\nvar R = typeof Reflect === 'object' ? Reflect : null\nvar ReflectApply = R && typeof R.apply === 'function'\n  ? R.apply\n  : function ReflectApply(target, receiver, args) {\n    return Function.prototype.apply.call(target, receiver, args);\n}\n\nmodule.exports = SafeEventEmitter\n\n\nfunction SafeEventEmitter() {\n  EventEmitter.call(this)\n}\n\nutil.inherits(SafeEventEmitter, EventEmitter)\n\nSafeEventEmitter.prototype.emit = function (type) {\n  // copied from https://github.com/Gozala/events/blob/master/events.js\n  // modified lines are commented with \"edited:\"\n  var args = [];\n  for (var i = 1; i < arguments.length; i++) args.push(arguments[i]);\n  var doError = (type === 'error');\n\n  var events = this._events;\n  if (events !== undefined)\n    doError = (doError && events.error === undefined);\n  else if (!doError)\n    return false;\n\n  // If there is no 'error' event listener then throw.\n  if (doError) {\n    var er;\n    if (args.length > 0)\n      er = args[0];\n    if (er instanceof Error) {\n      // Note: The comments on the `throw` lines are intentional, they show\n      // up in Node's output if this results in an unhandled exception.\n      throw er; // Unhandled 'error' event\n    }\n    // At least give some kind of context to the user\n    var err = new Error('Unhandled error.' + (er ? ' (' + er.message + ')' : ''));\n    err.context = er;\n    throw err; // Unhandled 'error' event\n  }\n\n  var handler = events[type];\n\n  if (handler === undefined)\n    return false;\n\n  if (typeof handler === 'function') {\n    // edited: using safeApply\n    safeApply(handler, this, args);\n  } else {\n    var len = handler.length;\n    var listeners = arrayClone(handler, len);\n    for (var i = 0; i < len; ++i)\n      // edited: using safeApply\n      safeApply(listeners[i], this, args);\n  }\n\n  return true;\n}\n\nfunction safeApply(handler, context, args) {\n  try {\n    ReflectApply(handler, context, args)\n  } catch (err) {\n    // throw error after timeout so as not to interupt the stack\n    setTimeout(() => {\n      throw err\n    })\n  }\n}\n\nfunction arrayClone(arr, n) {\n  var copy = new Array(n);\n  for (var i = 0; i < n; ++i)\n    copy[i] = arr[i];\n  return copy;\n}\n",null,null,null,null,null,null,"module.exports = function createScaffoldMiddleware (handlers) {\n  return (req, res, next, end) => {\n    const handler = handlers[req.method]\n    // if no handler, return\n    if (handler === undefined) {\n      return next()\n    }\n    // if handler is fn, call as middleware\n    if (typeof handler === 'function') {\n      return handler(req, res, next, end)\n    }\n    // if handler is some other value, use as result\n    res.result = handler\n    return end()\n  }\n}\n","const EthQuery = require('eth-query')\nconst pify = require('pify')\nconst BaseFilterWithHistory = require('./base-filter-history')\nconst { bnToHex, hexToInt, incrementHexInt, minBlockRef, blockRefIsNumber } = require('./hexUtils')\n\nclass LogFilter extends BaseFilterWithHistory {\n\n  constructor ({ provider, params }) {\n    super()\n    this.type = 'log'\n    this.ethQuery = new EthQuery(provider)\n    this.params = Object.assign({\n      fromBlock: 'latest',\n      toBlock: 'latest',\n      address: undefined,\n      topics: [],\n    }, params)\n    // normalize address parameter\n    if (this.params.address) {\n      // ensure array\n      if (!Array.isArray(this.params.address)) {\n        this.params.address = [this.params.address]\n      }\n      // ensure lowercase\n      this.params.address = this.params.address.map(address => address.toLowerCase())\n    }\n  }\n\n  async initialize({ currentBlock }) {\n    // resolve params.fromBlock\n    let fromBlock = this.params.fromBlock\n    if (['latest', 'pending'].includes(fromBlock)) fromBlock = currentBlock\n    if ('earliest' === fromBlock) fromBlock = '0x0'\n    this.params.fromBlock = fromBlock\n    // set toBlock for initial lookup\n    const toBlock = minBlockRef(this.params.toBlock, currentBlock)\n    const params = Object.assign({}, this.params, { toBlock })\n    // fetch logs and add to results\n    const newLogs = await this._fetchLogs(params)\n    this.addInitialResults(newLogs)\n  }\n\n  async update ({ oldBlock, newBlock }) {\n    // configure params for this update\n    const toBlock = newBlock\n    let fromBlock\n    // oldBlock is empty on first sync\n    if (oldBlock) {\n      fromBlock = incrementHexInt(oldBlock)\n    } else {\n      fromBlock = newBlock\n    }\n    // fetch logs\n    const params = Object.assign({}, this.params, { fromBlock, toBlock })\n    const newLogs = await this._fetchLogs(params)\n    const matchingLogs = newLogs.filter(log => this.matchLog(log))\n\n    // add to results\n    this.addResults(matchingLogs)\n  }\n\n  async _fetchLogs (params) {\n    const newLogs = await pify(cb => this.ethQuery.getLogs(params, cb))()\n    // add to results\n    return newLogs\n  }\n\n  matchLog(log) {\n    // check if block number in bounds:\n    if (hexToInt(this.params.fromBlock) >= hexToInt(log.blockNumber)) return false\n    if (blockRefIsNumber(this.params.toBlock) && hexToInt(this.params.toBlock) <= hexToInt(log.blockNumber)) return false\n\n    // address is correct:\n    const normalizedLogAddress = log.address && log.address.toLowerCase()\n    if (this.params.address && normalizedLogAddress && !this.params.address.includes(normalizedLogAddress)) return false\n\n    // topics match:\n    // topics are position-dependant\n    // topics can be nested to represent `or` [[a || b], c]\n    // topics can be null, representing a wild card for that position\n    const topicsMatch = this.params.topics.every((topicPattern, index) => {\n      // pattern is longer than actual topics\n      let logTopic = log.topics[index]\n      if (!logTopic) return false\n      logTopic = logTopic.toLowerCase()\n      // normalize subTopics\n      let subtopicsToMatch = Array.isArray(topicPattern) ? topicPattern : [topicPattern]\n      // check for wild card\n      const subtopicsIncludeWildcard = subtopicsToMatch.includes(null)\n      if (subtopicsIncludeWildcard) return true\n      subtopicsToMatch = subtopicsToMatch.map(topic => topic.toLowerCase())\n      // check each possible matching topic\n      const topicDoesMatch = subtopicsToMatch.includes(logTopic)\n      return topicDoesMatch\n    })\n\n    return topicsMatch\n  }\n\n}\n\nmodule.exports = LogFilter\n","'use strict';\n\nconst processFn = (fn, options, proxy, unwrapped) => function (...arguments_) {\n\tconst P = options.promiseModule;\n\n\treturn new P((resolve, reject) => {\n\t\tif (options.multiArgs) {\n\t\t\targuments_.push((...result) => {\n\t\t\t\tif (options.errorFirst) {\n\t\t\t\t\tif (result[0]) {\n\t\t\t\t\t\treject(result);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tresult.shift();\n\t\t\t\t\t\tresolve(result);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tresolve(result);\n\t\t\t\t}\n\t\t\t});\n\t\t} else if (options.errorFirst) {\n\t\t\targuments_.push((error, result) => {\n\t\t\t\tif (error) {\n\t\t\t\t\treject(error);\n\t\t\t\t} else {\n\t\t\t\t\tresolve(result);\n\t\t\t\t}\n\t\t\t});\n\t\t} else {\n\t\t\targuments_.push(resolve);\n\t\t}\n\n\t\tconst self = this === proxy ? unwrapped : this;\n\t\tReflect.apply(fn, self, arguments_);\n\t});\n};\n\nconst filterCache = new WeakMap();\n\nmodule.exports = (input, options) => {\n\toptions = {\n\t\texclude: [/.+(?:Sync|Stream)$/],\n\t\terrorFirst: true,\n\t\tpromiseModule: Promise,\n\t\t...options\n\t};\n\n\tconst objectType = typeof input;\n\tif (!(input !== null && (objectType === 'object' || objectType === 'function'))) {\n\t\tthrow new TypeError(`Expected \\`input\\` to be a \\`Function\\` or \\`Object\\`, got \\`${input === null ? 'null' : objectType}\\``);\n\t}\n\n\tconst filter = (target, key) => {\n\t\tlet cached = filterCache.get(target);\n\n\t\tif (!cached) {\n\t\t\tcached = {};\n\t\t\tfilterCache.set(target, cached);\n\t\t}\n\n\t\tif (key in cached) {\n\t\t\treturn cached[key];\n\t\t}\n\n\t\tconst match = pattern => (typeof pattern === 'string' || typeof key === 'symbol') ? key === pattern : pattern.test(key);\n\t\tconst desc = Reflect.getOwnPropertyDescriptor(target, key);\n\t\tconst writableOrConfigurableOwn = (desc === undefined || desc.writable || desc.configurable);\n\t\tconst included = options.include ? options.include.some(match) : !options.exclude.some(match);\n\t\tconst shouldFilter = included && writableOrConfigurableOwn;\n\t\tcached[key] = shouldFilter;\n\t\treturn shouldFilter;\n\t};\n\n\tconst cache = new WeakMap();\n\n\tconst proxy = new Proxy(input, {\n\t\tapply(target, thisArg, args) {\n\t\t\tconst cached = cache.get(target);\n\n\t\t\tif (cached) {\n\t\t\t\treturn Reflect.apply(cached, thisArg, args);\n\t\t\t}\n\n\t\t\tconst pified = options.excludeMain ? target : processFn(target, options, proxy, target);\n\t\t\tcache.set(target, pified);\n\t\t\treturn Reflect.apply(pified, thisArg, args);\n\t\t},\n\n\t\tget(target, key) {\n\t\t\tconst property = target[key];\n\n\t\t\t// eslint-disable-next-line no-use-extend-native/no-use-extend-native\n\t\t\tif (!filter(target, key) || property === Function.prototype[key]) {\n\t\t\t\treturn property;\n\t\t\t}\n\n\t\t\tconst cached = cache.get(property);\n\n\t\t\tif (cached) {\n\t\t\t\treturn cached;\n\t\t\t}\n\n\t\t\tif (typeof property === 'function') {\n\t\t\t\tconst pified = processFn(property, options, proxy, target);\n\t\t\t\tcache.set(property, pified);\n\t\t\t\treturn pified;\n\t\t\t}\n\n\t\t\treturn property;\n\t\t}\n\t});\n\n\treturn proxy;\n};\n","const BaseFilter = require('./base-filter')\n\n// tracks all results ever recorded\nclass BaseFilterWithHistory extends BaseFilter {\n\n  constructor () {\n    super()\n    this.allResults = []\n  }\n\n  async update () {\n    throw new Error('BaseFilterWithHistory - no update method specified')\n  }\n\n  addResults (newResults) {\n    this.allResults = this.allResults.concat(newResults)\n    super.addResults(newResults)\n  }\n\n  addInitialResults (newResults) {\n    this.allResults = this.allResults.concat(newResults)\n    super.addInitialResults(newResults)\n  }\n\n  getAllResults () {\n    return this.allResults\n  }\n\n}\n\nmodule.exports = BaseFilterWithHistory","const BaseFilter = require('./base-filter')\nconst getBlocksForRange = require('./getBlocksForRange')\nconst { incrementHexInt } = require('./hexUtils')\n\nclass BlockFilter extends BaseFilter {\n\n  constructor ({ provider, params }) {\n    super()\n    this.type = 'block'\n    this.provider = provider\n  }\n\n  async update ({ oldBlock, newBlock }) {\n    const toBlock = newBlock\n    const fromBlock = incrementHexInt(oldBlock)\n    const blockBodies = await getBlocksForRange({ provider: this.provider, fromBlock, toBlock })\n    const blockHashes = blockBodies.map((block) => block.hash)\n    this.addResults(blockHashes)\n  }\n\n}\n\nmodule.exports = BlockFilter\n","const BaseFilter = require('./base-filter')\nconst getBlocksForRange = require('./getBlocksForRange')\nconst { incrementHexInt } = require('./hexUtils')\n\nclass TxFilter extends BaseFilter {\n\n  constructor ({ provider }) {\n    super()\n    this.type = 'tx'\n    this.provider = provider\n  }\n\n  async update ({ oldBlock }) {\n    const toBlock = oldBlock\n    const fromBlock = incrementHexInt(oldBlock)\n    const blocks = await getBlocksForRange({ provider: this.provider, fromBlock, toBlock })\n    const blockTxHashes = []\n    for (const block of blocks) {\n      blockTxHashes.push(...block.transactions)\n    }\n    // add to results\n    this.addResults(blockTxHashes)\n  }\n\n}\n\nmodule.exports = TxFilter\n","import { __awaiter, __generator } from \"tslib\";\nvar Semaphore = /** @class */ (function () {\n    function Semaphore(_maxConcurrency) {\n        this._maxConcurrency = _maxConcurrency;\n        this._queue = [];\n        if (_maxConcurrency <= 0) {\n            throw new Error('semaphore must be initialized to a positive value');\n        }\n        this._value = _maxConcurrency;\n    }\n    Semaphore.prototype.acquire = function () {\n        var _this = this;\n        var locked = this.isLocked();\n        var ticket = new Promise(function (r) { return _this._queue.push(r); });\n        if (!locked)\n            this._dispatch();\n        return ticket;\n    };\n    Semaphore.prototype.runExclusive = function (callback) {\n        return __awaiter(this, void 0, void 0, function () {\n            var _a, value, release;\n            return __generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0: return [4 /*yield*/, this.acquire()];\n                    case 1:\n                        _a = _b.sent(), value = _a[0], release = _a[1];\n                        _b.label = 2;\n                    case 2:\n                        _b.trys.push([2, , 4, 5]);\n                        return [4 /*yield*/, callback(value)];\n                    case 3: return [2 /*return*/, _b.sent()];\n                    case 4:\n                        release();\n                        return [7 /*endfinally*/];\n                    case 5: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    Semaphore.prototype.isLocked = function () {\n        return this._value <= 0;\n    };\n    Semaphore.prototype.release = function () {\n        if (this._maxConcurrency > 1) {\n            throw new Error('this method is unavailabel on semaphores with concurrency > 1; use the scoped release returned by acquire instead');\n        }\n        if (this._currentReleaser) {\n            var releaser = this._currentReleaser;\n            this._currentReleaser = undefined;\n            releaser();\n        }\n    };\n    Semaphore.prototype._dispatch = function () {\n        var _this = this;\n        var nextConsumer = this._queue.shift();\n        if (!nextConsumer)\n            return;\n        var released = false;\n        this._currentReleaser = function () {\n            if (released)\n                return;\n            released = true;\n            _this._value++;\n            _this._dispatch();\n        };\n        nextConsumer([this._value--, this._currentReleaser]);\n    };\n    return Semaphore;\n}());\nexport default Semaphore;\n","import { __awaiter, __generator } from \"tslib\";\nimport Semaphore from './Semaphore';\nvar Mutex = /** @class */ (function () {\n    function Mutex() {\n        this._semaphore = new Semaphore(1);\n    }\n    Mutex.prototype.acquire = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            var _a, releaser;\n            return __generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0: return [4 /*yield*/, this._semaphore.acquire()];\n                    case 1:\n                        _a = _b.sent(), releaser = _a[1];\n                        return [2 /*return*/, releaser];\n                }\n            });\n        });\n    };\n    Mutex.prototype.runExclusive = function (callback) {\n        return this._semaphore.runExclusive(function () { return callback(); });\n    };\n    Mutex.prototype.isLocked = function () {\n        return this._semaphore.isLocked();\n    };\n    Mutex.prototype.release = function () {\n        this._semaphore.release();\n    };\n    return Mutex;\n}());\nexport default Mutex;\n","import { __awaiter, __generator } from \"tslib\";\n// eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types\nexport function withTimeout(sync, timeout, timeoutError) {\n    var _this = this;\n    if (timeoutError === void 0) { timeoutError = new Error('timeout'); }\n    return {\n        acquire: function () {\n            return new Promise(function (resolve, reject) { return __awaiter(_this, void 0, void 0, function () {\n                var isTimeout, ticket, release;\n                return __generator(this, function (_a) {\n                    switch (_a.label) {\n                        case 0:\n                            isTimeout = false;\n                            setTimeout(function () {\n                                isTimeout = true;\n                                reject(timeoutError);\n                            }, timeout);\n                            return [4 /*yield*/, sync.acquire()];\n                        case 1:\n                            ticket = _a.sent();\n                            if (isTimeout) {\n                                release = Array.isArray(ticket) ? ticket[1] : ticket;\n                                release();\n                            }\n                            else {\n                                resolve(ticket);\n                            }\n                            return [2 /*return*/];\n                    }\n                });\n            }); });\n        },\n        runExclusive: function (callback) {\n            return __awaiter(this, void 0, void 0, function () {\n                var release, ticket;\n                return __generator(this, function (_a) {\n                    switch (_a.label) {\n                        case 0:\n                            release = function () { return undefined; };\n                            _a.label = 1;\n                        case 1:\n                            _a.trys.push([1, , 7, 8]);\n                            return [4 /*yield*/, this.acquire()];\n                        case 2:\n                            ticket = _a.sent();\n                            if (!Array.isArray(ticket)) return [3 /*break*/, 4];\n                            release = ticket[1];\n                            return [4 /*yield*/, callback(ticket[0])];\n                        case 3: return [2 /*return*/, _a.sent()];\n                        case 4:\n                            release = ticket;\n                            return [4 /*yield*/, callback()];\n                        case 5: return [2 /*return*/, _a.sent()];\n                        case 6: return [3 /*break*/, 8];\n                        case 7:\n                            release();\n                            return [7 /*endfinally*/];\n                        case 8: return [2 /*return*/];\n                    }\n                });\n            });\n        },\n        release: function () {\n            sync.release();\n        },\n        isLocked: function () { return sync.isLocked(); },\n    };\n}\n","var arrayWithoutHoles = require(\"./arrayWithoutHoles.js\");\nvar iterableToArray = require(\"./iterableToArray.js\");\nvar unsupportedIterableToArray = require(\"./unsupportedIterableToArray.js\");\nvar nonIterableSpread = require(\"./nonIterableSpread.js\");\nfunction _toConsumableArray(arr) {\n  return arrayWithoutHoles(arr) || iterableToArray(arr) || unsupportedIterableToArray(arr) || nonIterableSpread();\n}\nmodule.exports = _toConsumableArray, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","\nmodule.exports = {\n  minBlockRef,\n  maxBlockRef,\n  sortBlockRefs,\n  bnToHex,\n  blockRefIsNumber,\n  hexToInt,\n  incrementHexInt,\n  intToHex,\n  unsafeRandomBytes,\n}\n\nfunction minBlockRef(...refs) {\n  const sortedRefs = sortBlockRefs(refs)\n  return sortedRefs[0]\n}\n\nfunction maxBlockRef(...refs) {\n  const sortedRefs = sortBlockRefs(refs)\n  return sortedRefs[sortedRefs.length-1]\n}\n\nfunction sortBlockRefs(refs) {\n  return refs.sort((refA, refB) => {\n    if (refA === 'latest' || refB === 'earliest') return 1\n    if (refB === 'latest' || refA === 'earliest') return -1\n    return hexToInt(refA) - hexToInt(refB)\n  })\n}\n\nfunction bnToHex(bn) {\n  return '0x' + bn.toString(16)\n}\n\nfunction blockRefIsNumber(blockRef){\n  return blockRef && !['earliest', 'latest', 'pending'].includes(blockRef)\n}\n\nfunction hexToInt(hexString) {\n  if (hexString === undefined || hexString === null) return hexString\n  return Number.parseInt(hexString, 16)\n}\n\nfunction incrementHexInt(hexString){\n  if (hexString === undefined || hexString === null) return hexString\n  const value = hexToInt(hexString)\n  return intToHex(value + 1)\n}\n\nfunction intToHex(int) {\n  if (int === undefined || int === null) return int\n  let hexString = int.toString(16)\n  const needsLeftPad = hexString.length % 2\n  if (needsLeftPad) hexString = '0' + hexString\n  return '0x' + hexString\n}\n\nfunction unsafeRandomBytes(byteCount) {\n  let result = '0x'\n  for (let i = 0; i < byteCount; i++) {\n    result += unsafeRandomNibble()\n    result += unsafeRandomNibble()\n  }\n  return result\n}\n\nfunction unsafeRandomNibble() {\n  return Math.floor(Math.random() * 16).toString(16)\n}\n","module.exports = extend\n\nvar hasOwnProperty = Object.prototype.hasOwnProperty;\n\nfunction extend() {\n    var target = {}\n\n    for (var i = 0; i < arguments.length; i++) {\n        var source = arguments[i]\n\n        for (var key in source) {\n            if (hasOwnProperty.call(source, key)) {\n                target[key] = source[key]\n            }\n        }\n    }\n\n    return target\n}\n",null,null,null,"const SafeEventEmitter = require('@metamask/safe-event-emitter').default\n\nclass BaseFilter extends SafeEventEmitter {\n\n  constructor () {\n    super()\n    this.updates = []\n  }\n\n  async initialize () {}\n\n  async update () {\n    throw new Error('BaseFilter - no update method specified')\n  }\n\n  addResults (newResults) {\n    this.updates = this.updates.concat(newResults)\n    newResults.forEach(result => this.emit('update', result))\n  }\n\n  addInitialResults (newResults) {}\n\n  getChangesAndClear () {\n    const updates = this.updates\n    this.updates = []\n    return updates\n  }\n  \n}\n\nmodule.exports = BaseFilter\n","module.exports = getBlocksForRange\n\nasync function getBlocksForRange({ provider, fromBlock, toBlock }) {\n  if (!fromBlock) fromBlock = toBlock\n\n  const fromBlockNumber = hexToInt(fromBlock)\n  const toBlockNumber = hexToInt(toBlock)\n  const blockCountToQuery = toBlockNumber - fromBlockNumber + 1\n  // load all blocks from old to new (inclusive)\n  const missingBlockNumbers = Array(blockCountToQuery).fill()\n                              .map((_,index) => fromBlockNumber + index)\n                              .map(intToHex)\n  const blockBodies = await Promise.all(\n    missingBlockNumbers.map(blockNum => query(provider, 'eth_getBlockByNumber', [blockNum, false]))\n  )\n  return blockBodies\n}\n\nfunction hexToInt(hexString) {\n  if (hexString === undefined || hexString === null) return hexString\n  return Number.parseInt(hexString, 16)\n}\n\nfunction incrementHexInt(hexString){\n  if (hexString === undefined || hexString === null) return hexString\n  const value = hexToInt(hexString)\n  return intToHex(value + 1)\n}\n\nfunction intToHex(int) {\n  if (int === undefined || int === null) return int\n  const hexString = int.toString(16)\n  return '0x' + hexString\n}\n\nfunction query(provider, method, params) {\n  return new Promise((resolve, reject) => {\n    provider.sendAsync({ id: 1, jsonrpc: '2.0', method, params }, (err, res) => {\n      if (err) return reject(err)\n      resolve(res.result)\n    })\n  })\n}\n","const pify = require('pify')\nconst BaseBlockTracker = require('./base')\n\nconst sec = 1000\n\nclass PollingBlockTracker extends BaseBlockTracker {\n\n  constructor (opts = {}) {\n    // parse + validate args\n    if (!opts.provider) throw new Error('PollingBlockTracker - no provider specified.')\n    const pollingInterval = opts.pollingInterval || 20 * sec\n    const retryTimeout = opts.retryTimeout || pollingInterval / 10\n    const keepEventLoopActive = opts.keepEventLoopActive !== undefined ? opts.keepEventLoopActive : true\n    const setSkipCacheFlag = opts.setSkipCacheFlag || false\n    // BaseBlockTracker constructor\n    super(Object.assign({\n      blockResetDuration: pollingInterval,\n    }, opts))\n    // config\n    this._provider = opts.provider\n    this._pollingInterval = pollingInterval\n    this._retryTimeout = retryTimeout\n    this._keepEventLoopActive = keepEventLoopActive\n    this._setSkipCacheFlag = setSkipCacheFlag\n  }\n\n  //\n  // public\n  //\n\n  // trigger block polling\n  async checkForLatestBlock () {\n    await this._updateLatestBlock()\n    return await this.getLatestBlock()\n  }\n\n  //\n  // private\n  //\n\n  _start () {\n    this._performSync().catch(err => this.emit('error', err))\n  }\n\n  async _performSync () {\n    while (this._isRunning) {\n      try {\n        await this._updateLatestBlock()\n        await timeout(this._pollingInterval, !this._keepEventLoopActive)\n      } catch (err) {\n        const newErr = new Error(`PollingBlockTracker - encountered an error while attempting to update latest block:\\n${err.stack}`)\n        try {\n          this.emit('error', newErr)\n        } catch (emitErr) {\n          console.error(newErr)\n        }\n        await timeout(this._retryTimeout, !this._keepEventLoopActive)\n      }\n    }\n  }\n\n  async _updateLatestBlock () {\n    // fetch + set latest block\n    const latestBlock = await this._fetchLatestBlock()\n    this._newPotentialLatest(latestBlock)\n  }\n\n  async _fetchLatestBlock () {\n    const req = { jsonrpc: \"2.0\", id: 1, method: 'eth_blockNumber', params: [] }\n    if (this._setSkipCacheFlag) req.skipCache = true\n    const res = await pify((cb) => this._provider.sendAsync(req, cb))()\n    if (res.error) throw new Error(`PollingBlockTracker - encountered error fetching block:\\n${res.error}`)\n    return res.result\n  }\n\n}\n\nmodule.exports = PollingBlockTracker\n\nfunction timeout (duration, unref) {\n  return new Promise(resolve => {\n    const timoutRef = setTimeout(resolve, duration)\n    // don't keep process open\n    if (timoutRef.unref && unref) {\n      timoutRef.unref()\n    }\n  })\n}\n","'use strict';\n\nconst processFn = (fn, opts) => function () {\n\tconst P = opts.promiseModule;\n\tconst args = new Array(arguments.length);\n\n\tfor (let i = 0; i < arguments.length; i++) {\n\t\targs[i] = arguments[i];\n\t}\n\n\treturn new P((resolve, reject) => {\n\t\tif (opts.errorFirst) {\n\t\t\targs.push(function (err, result) {\n\t\t\t\tif (opts.multiArgs) {\n\t\t\t\t\tconst results = new Array(arguments.length - 1);\n\n\t\t\t\t\tfor (let i = 1; i < arguments.length; i++) {\n\t\t\t\t\t\tresults[i - 1] = arguments[i];\n\t\t\t\t\t}\n\n\t\t\t\t\tif (err) {\n\t\t\t\t\t\tresults.unshift(err);\n\t\t\t\t\t\treject(results);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tresolve(results);\n\t\t\t\t\t}\n\t\t\t\t} else if (err) {\n\t\t\t\t\treject(err);\n\t\t\t\t} else {\n\t\t\t\t\tresolve(result);\n\t\t\t\t}\n\t\t\t});\n\t\t} else {\n\t\t\targs.push(function (result) {\n\t\t\t\tif (opts.multiArgs) {\n\t\t\t\t\tconst results = new Array(arguments.length - 1);\n\n\t\t\t\t\tfor (let i = 0; i < arguments.length; i++) {\n\t\t\t\t\t\tresults[i] = arguments[i];\n\t\t\t\t\t}\n\n\t\t\t\t\tresolve(results);\n\t\t\t\t} else {\n\t\t\t\t\tresolve(result);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tfn.apply(this, args);\n\t});\n};\n\nmodule.exports = (obj, opts) => {\n\topts = Object.assign({\n\t\texclude: [/.+(Sync|Stream)$/],\n\t\terrorFirst: true,\n\t\tpromiseModule: Promise\n\t}, opts);\n\n\tconst filter = key => {\n\t\tconst match = pattern => typeof pattern === 'string' ? key === pattern : pattern.test(key);\n\t\treturn opts.include ? opts.include.some(match) : !opts.exclude.some(match);\n\t};\n\n\tlet ret;\n\tif (typeof obj === 'function') {\n\t\tret = function () {\n\t\t\tif (opts.excludeMain) {\n\t\t\t\treturn obj.apply(this, arguments);\n\t\t\t}\n\n\t\t\treturn processFn(obj, opts).apply(this, arguments);\n\t\t};\n\t} else {\n\t\tret = Object.create(Object.getPrototypeOf(obj));\n\t}\n\n\tfor (const key in obj) { // eslint-disable-line guard-for-in\n\t\tconst x = obj[key];\n\t\tret[key] = typeof x === 'function' && filter(key) ? processFn(x, opts) : x;\n\t}\n\n\treturn ret;\n};\n","var superPropBase = require(\"./superPropBase.js\");\nfunction _get() {\n  if (typeof Reflect !== \"undefined\" && Reflect.get) {\n    module.exports = _get = Reflect.get.bind(), module.exports.__esModule = true, module.exports[\"default\"] = module.exports;\n  } else {\n    module.exports = _get = function _get(target, property, receiver) {\n      var base = superPropBase(target, property);\n      if (!base) return;\n      var desc = Object.getOwnPropertyDescriptor(base, property);\n      if (desc.get) {\n        return desc.get.call(arguments.length < 3 ? target : receiver);\n      }\n      return desc.value;\n    }, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;\n  }\n  return _get.apply(this, arguments);\n}\nmodule.exports = _get, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","const extend = require('xtend')\nconst createRandomId = require('json-rpc-random-id')()\n\nmodule.exports = EthQuery\n\n\nfunction EthQuery(provider){\n  const self = this\n  self.currentProvider = provider\n}\n\n//\n// base queries\n//\n\n// default block\nEthQuery.prototype.getBalance =                          generateFnWithDefaultBlockFor(2, 'eth_getBalance')\nEthQuery.prototype.getCode =                             generateFnWithDefaultBlockFor(2, 'eth_getCode')\nEthQuery.prototype.getTransactionCount =                 generateFnWithDefaultBlockFor(2, 'eth_getTransactionCount')\nEthQuery.prototype.getStorageAt =                        generateFnWithDefaultBlockFor(3, 'eth_getStorageAt')\nEthQuery.prototype.call =                                generateFnWithDefaultBlockFor(2, 'eth_call')\n// standard\nEthQuery.prototype.protocolVersion =                     generateFnFor('eth_protocolVersion')\nEthQuery.prototype.syncing =                             generateFnFor('eth_syncing')\nEthQuery.prototype.coinbase =                            generateFnFor('eth_coinbase')\nEthQuery.prototype.mining =                              generateFnFor('eth_mining')\nEthQuery.prototype.hashrate =                            generateFnFor('eth_hashrate')\nEthQuery.prototype.gasPrice =                            generateFnFor('eth_gasPrice')\nEthQuery.prototype.accounts =                            generateFnFor('eth_accounts')\nEthQuery.prototype.blockNumber =                         generateFnFor('eth_blockNumber')\nEthQuery.prototype.getBlockTransactionCountByHash =      generateFnFor('eth_getBlockTransactionCountByHash')\nEthQuery.prototype.getBlockTransactionCountByNumber =    generateFnFor('eth_getBlockTransactionCountByNumber')\nEthQuery.prototype.getUncleCountByBlockHash =            generateFnFor('eth_getUncleCountByBlockHash')\nEthQuery.prototype.getUncleCountByBlockNumber =          generateFnFor('eth_getUncleCountByBlockNumber')\nEthQuery.prototype.sign =                                generateFnFor('eth_sign')\nEthQuery.prototype.sendTransaction =                     generateFnFor('eth_sendTransaction')\nEthQuery.prototype.sendRawTransaction =                  generateFnFor('eth_sendRawTransaction')\nEthQuery.prototype.estimateGas =                         generateFnFor('eth_estimateGas')\nEthQuery.prototype.getBlockByHash =                      generateFnFor('eth_getBlockByHash')\nEthQuery.prototype.getBlockByNumber =                    generateFnFor('eth_getBlockByNumber')\nEthQuery.prototype.getTransactionByHash =                generateFnFor('eth_getTransactionByHash')\nEthQuery.prototype.getTransactionByBlockHashAndIndex =   generateFnFor('eth_getTransactionByBlockHashAndIndex')\nEthQuery.prototype.getTransactionByBlockNumberAndIndex = generateFnFor('eth_getTransactionByBlockNumberAndIndex')\nEthQuery.prototype.getTransactionReceipt =               generateFnFor('eth_getTransactionReceipt')\nEthQuery.prototype.getUncleByBlockHashAndIndex =         generateFnFor('eth_getUncleByBlockHashAndIndex')\nEthQuery.prototype.getUncleByBlockNumberAndIndex =       generateFnFor('eth_getUncleByBlockNumberAndIndex')\nEthQuery.prototype.getCompilers =                        generateFnFor('eth_getCompilers')\nEthQuery.prototype.compileLLL =                          generateFnFor('eth_compileLLL')\nEthQuery.prototype.compileSolidity =                     generateFnFor('eth_compileSolidity')\nEthQuery.prototype.compileSerpent =                      generateFnFor('eth_compileSerpent')\nEthQuery.prototype.newFilter =                           generateFnFor('eth_newFilter')\nEthQuery.prototype.newBlockFilter =                      generateFnFor('eth_newBlockFilter')\nEthQuery.prototype.newPendingTransactionFilter =         generateFnFor('eth_newPendingTransactionFilter')\nEthQuery.prototype.uninstallFilter =                     generateFnFor('eth_uninstallFilter')\nEthQuery.prototype.getFilterChanges =                    generateFnFor('eth_getFilterChanges')\nEthQuery.prototype.getFilterLogs =                       generateFnFor('eth_getFilterLogs')\nEthQuery.prototype.getLogs =                             generateFnFor('eth_getLogs')\nEthQuery.prototype.getWork =                             generateFnFor('eth_getWork')\nEthQuery.prototype.submitWork =                          generateFnFor('eth_submitWork')\nEthQuery.prototype.submitHashrate =                      generateFnFor('eth_submitHashrate')\n\n// network level\n\nEthQuery.prototype.sendAsync = function(opts, cb){\n  const self = this\n  self.currentProvider.sendAsync(createPayload(opts), function(err, response){\n    if (!err && response.error) err = new Error('EthQuery - RPC Error - '+response.error.message)\n    if (err) return cb(err)\n    cb(null, response.result)\n  })\n}\n\n// util\n\nfunction generateFnFor(methodName){\n  return function(){\n    const self = this\n    var args = [].slice.call(arguments)\n    var cb = args.pop()\n    self.sendAsync({\n      method: methodName,\n      params: args,\n    }, cb)\n  }\n}\n\nfunction generateFnWithDefaultBlockFor(argCount, methodName){\n  return function(){\n    const self = this\n    var args = [].slice.call(arguments)\n    var cb = args.pop()\n    // set optional default block param\n    if (args.length < argCount) args.push('latest')\n    self.sendAsync({\n      method: methodName,\n      params: args,\n    }, cb)\n  }\n}\n\nfunction createPayload(data){\n  return extend({\n    // defaults\n    id: createRandomId(),\n    jsonrpc: '2.0',\n    params: [],\n    // user-specified\n  }, data)\n}\n","const Mutex = require('async-mutex').Mutex\nconst { createAsyncMiddleware } = require('json-rpc-engine')\nconst createJsonRpcMiddleware = require('eth-json-rpc-middleware/scaffold')\nconst LogFilter = require('./log-filter.js')\nconst BlockFilter = require('./block-filter.js')\nconst TxFilter = require('./tx-filter.js')\nconst { intToHex, hexToInt } = require('./hexUtils')\n\nmodule.exports = createEthFilterMiddleware\n\nfunction createEthFilterMiddleware({ blockTracker, provider }) {\n\n  // create filter collection\n  let filterIndex = 0\n  let filters = {}\n  // create update mutex\n  const mutex = new Mutex()\n  const waitForFree = mutexMiddlewareWrapper({ mutex })\n\n  const middleware = createJsonRpcMiddleware({\n    // install filters\n    eth_newFilter:                   waitForFree(toFilterCreationMiddleware(newLogFilter)),\n    eth_newBlockFilter:              waitForFree(toFilterCreationMiddleware(newBlockFilter)),\n    eth_newPendingTransactionFilter: waitForFree(toFilterCreationMiddleware(newPendingTransactionFilter)),\n    // uninstall filters\n    eth_uninstallFilter:             waitForFree(toAsyncRpcMiddleware(uninstallFilterHandler)),\n    // checking filter changes\n    eth_getFilterChanges:            waitForFree(toAsyncRpcMiddleware(getFilterChanges)),\n    eth_getFilterLogs:               waitForFree(toAsyncRpcMiddleware(getFilterLogs)),\n  })\n\n  // setup filter updating and destroy handler\n  const filterUpdater = async ({ oldBlock, newBlock }) => {\n    if (filters.length === 0) return\n    // lock update reads\n    const releaseLock = await mutex.acquire()\n    try {\n      // process all filters in parallel\n      await Promise.all(objValues(filters).map(async (filter) => {\n        try {\n         await filter.update({ oldBlock, newBlock })\n        } catch (err) {\n          // handle each error individually so filter update errors don't affect other filters\n          console.error(err)\n        }\n      }))\n    } catch (err) {\n      // log error so we don't skip the releaseLock\n      console.error(err)\n    }\n    // unlock update reads\n    releaseLock()\n  }\n\n  // expose filter methods directly\n  middleware.newLogFilter = newLogFilter\n  middleware.newBlockFilter = newBlockFilter\n  middleware.newPendingTransactionFilter = newPendingTransactionFilter\n  middleware.uninstallFilter = uninstallFilterHandler\n  middleware.getFilterChanges = getFilterChanges\n  middleware.getFilterLogs = getFilterLogs\n\n  // expose destroy method for cleanup\n  middleware.destroy = () => {\n    uninstallAllFilters()\n  }\n\n  return middleware\n\n  //\n  // new filters\n  //\n\n  async function newLogFilter(params) {\n    const filter = new LogFilter({ provider, params })\n    const filterIndex = await installFilter(filter)\n    return filter\n  }\n\n  async function newBlockFilter() {\n    const filter = new BlockFilter({ provider })\n    const filterIndex = await installFilter(filter)\n    return filter\n  }\n\n  async function newPendingTransactionFilter() {\n    const filter = new TxFilter({ provider })\n    const filterIndex = await installFilter(filter)\n    return filter\n  }\n\n  //\n  // get filter changes\n  //\n\n  async function getFilterChanges(filterIndexHex) {\n    const filterIndex = hexToInt(filterIndexHex)\n    const filter = filters[filterIndex]\n    if (!filter) {\n      throw new Error(`No filter for index \"${filterIndex}\"`)\n    }\n    const results = filter.getChangesAndClear()\n    return results\n  }\n\n  async function getFilterLogs(filterIndexHex) {\n    const filterIndex = hexToInt(filterIndexHex)\n    const filter = filters[filterIndex]\n    if (!filter) {\n      throw new Error(`No filter for index \"${filterIndex}\"`)\n    }\n    // only return results for log filters\n    if (filter.type === 'log') {\n      results = filter.getAllResults()\n    } else {\n      results = []\n    }\n    return results\n  }\n\n\n  //\n  // remove filters\n  //\n\n\n  async function uninstallFilterHandler(filterIndexHex) {\n    // check filter exists\n    const filterIndex = hexToInt(filterIndexHex)\n    const filter = filters[filterIndex]\n    const result = Boolean(filter)\n    // uninstall filter\n    if (result) {\n      await uninstallFilter(filterIndex)\n    }\n    return result\n  }\n\n  //\n  // utils\n  //\n\n  async function installFilter(filter) {\n    const prevFilterCount = objValues(filters).length\n    // install filter\n    const currentBlock = await blockTracker.getLatestBlock()\n    await filter.initialize({ currentBlock })\n    filterIndex++\n    filters[filterIndex] = filter\n    filter.id = filterIndex\n    filter.idHex = intToHex(filterIndex)\n    // update block tracker subs\n    const newFilterCount = objValues(filters).length\n    updateBlockTrackerSubs({ prevFilterCount, newFilterCount })\n    return filterIndex\n  }\n\n  async function uninstallFilter(filterIndex) {\n    const prevFilterCount = objValues(filters).length\n    delete filters[filterIndex]\n    // update block tracker subs\n    const newFilterCount = objValues(filters).length\n    updateBlockTrackerSubs({ prevFilterCount, newFilterCount })\n  }\n\n  async function uninstallAllFilters() {\n    const prevFilterCount = objValues(filters).length\n    filters = {}\n    // update block tracker subs\n    updateBlockTrackerSubs({ prevFilterCount, newFilterCount: 0 })\n  }\n\n  function updateBlockTrackerSubs({ prevFilterCount, newFilterCount }) {\n    // subscribe\n    if (prevFilterCount === 0 && newFilterCount > 0) {\n      blockTracker.on('sync', filterUpdater)\n      return\n    }\n    // unsubscribe\n    if (prevFilterCount > 0 && newFilterCount === 0) {\n      blockTracker.removeListener('sync', filterUpdater)\n      return\n    }\n  }\n\n}\n\n// helper for turning filter constructors into rpc middleware\nfunction toFilterCreationMiddleware(createFilterFn) {\n  return toAsyncRpcMiddleware(async (...args) => {\n    const filter = await createFilterFn(...args)\n    const result = intToHex(filter.id)\n    return result\n  })\n}\n\n// helper for pulling out req.params and setting res.result\nfunction toAsyncRpcMiddleware(asyncFn) {\n  return createAsyncMiddleware(async (req, res) => {\n    const result = await asyncFn.apply(null, req.params)\n    res.result = result\n  })\n}\n\nfunction mutexMiddlewareWrapper({ mutex }) {\n  return (middleware) => {\n    return async (req, res, next, end) => {\n      // wait for mutex available\n      // we can release immediately because\n      // we just need to make sure updates aren't active\n      const releaseLock = await mutex.acquire()\n      releaseLock()\n      middleware(req, res, next, end)\n    }\n  }\n}\n\nfunction objValues(obj, fn){\n  const values = []\n  for (let key in obj) {\n    values.push(obj[key])\n  }\n  return values\n}\n",null,null,"module.exports = stringify\nstringify.default = stringify\nstringify.stable = deterministicStringify\nstringify.stableStringify = deterministicStringify\n\nvar LIMIT_REPLACE_NODE = '[...]'\nvar CIRCULAR_REPLACE_NODE = '[Circular]'\n\nvar arr = []\nvar replacerStack = []\n\nfunction defaultOptions () {\n  return {\n    depthLimit: Number.MAX_SAFE_INTEGER,\n    edgesLimit: Number.MAX_SAFE_INTEGER\n  }\n}\n\n// Regular stringify\nfunction stringify (obj, replacer, spacer, options) {\n  if (typeof options === 'undefined') {\n    options = defaultOptions()\n  }\n\n  decirc(obj, '', 0, [], undefined, 0, options)\n  var res\n  try {\n    if (replacerStack.length === 0) {\n      res = JSON.stringify(obj, replacer, spacer)\n    } else {\n      res = JSON.stringify(obj, replaceGetterValues(replacer), spacer)\n    }\n  } catch (_) {\n    return JSON.stringify('[unable to serialize, circular reference is too complex to analyze]')\n  } finally {\n    while (arr.length !== 0) {\n      var part = arr.pop()\n      if (part.length === 4) {\n        Object.defineProperty(part[0], part[1], part[3])\n      } else {\n        part[0][part[1]] = part[2]\n      }\n    }\n  }\n  return res\n}\n\nfunction setReplace (replace, val, k, parent) {\n  var propertyDescriptor = Object.getOwnPropertyDescriptor(parent, k)\n  if (propertyDescriptor.get !== undefined) {\n    if (propertyDescriptor.configurable) {\n      Object.defineProperty(parent, k, { value: replace })\n      arr.push([parent, k, val, propertyDescriptor])\n    } else {\n      replacerStack.push([val, k, replace])\n    }\n  } else {\n    parent[k] = replace\n    arr.push([parent, k, val])\n  }\n}\n\nfunction decirc (val, k, edgeIndex, stack, parent, depth, options) {\n  depth += 1\n  var i\n  if (typeof val === 'object' && val !== null) {\n    for (i = 0; i < stack.length; i++) {\n      if (stack[i] === val) {\n        setReplace(CIRCULAR_REPLACE_NODE, val, k, parent)\n        return\n      }\n    }\n\n    if (\n      typeof options.depthLimit !== 'undefined' &&\n      depth > options.depthLimit\n    ) {\n      setReplace(LIMIT_REPLACE_NODE, val, k, parent)\n      return\n    }\n\n    if (\n      typeof options.edgesLimit !== 'undefined' &&\n      edgeIndex + 1 > options.edgesLimit\n    ) {\n      setReplace(LIMIT_REPLACE_NODE, val, k, parent)\n      return\n    }\n\n    stack.push(val)\n    // Optimize for Arrays. Big arrays could kill the performance otherwise!\n    if (Array.isArray(val)) {\n      for (i = 0; i < val.length; i++) {\n        decirc(val[i], i, i, stack, val, depth, options)\n      }\n    } else {\n      var keys = Object.keys(val)\n      for (i = 0; i < keys.length; i++) {\n        var key = keys[i]\n        decirc(val[key], key, i, stack, val, depth, options)\n      }\n    }\n    stack.pop()\n  }\n}\n\n// Stable-stringify\nfunction compareFunction (a, b) {\n  if (a < b) {\n    return -1\n  }\n  if (a > b) {\n    return 1\n  }\n  return 0\n}\n\nfunction deterministicStringify (obj, replacer, spacer, options) {\n  if (typeof options === 'undefined') {\n    options = defaultOptions()\n  }\n\n  var tmp = deterministicDecirc(obj, '', 0, [], undefined, 0, options) || obj\n  var res\n  try {\n    if (replacerStack.length === 0) {\n      res = JSON.stringify(tmp, replacer, spacer)\n    } else {\n      res = JSON.stringify(tmp, replaceGetterValues(replacer), spacer)\n    }\n  } catch (_) {\n    return JSON.stringify('[unable to serialize, circular reference is too complex to analyze]')\n  } finally {\n    // Ensure that we restore the object as it was.\n    while (arr.length !== 0) {\n      var part = arr.pop()\n      if (part.length === 4) {\n        Object.defineProperty(part[0], part[1], part[3])\n      } else {\n        part[0][part[1]] = part[2]\n      }\n    }\n  }\n  return res\n}\n\nfunction deterministicDecirc (val, k, edgeIndex, stack, parent, depth, options) {\n  depth += 1\n  var i\n  if (typeof val === 'object' && val !== null) {\n    for (i = 0; i < stack.length; i++) {\n      if (stack[i] === val) {\n        setReplace(CIRCULAR_REPLACE_NODE, val, k, parent)\n        return\n      }\n    }\n    try {\n      if (typeof val.toJSON === 'function') {\n        return\n      }\n    } catch (_) {\n      return\n    }\n\n    if (\n      typeof options.depthLimit !== 'undefined' &&\n      depth > options.depthLimit\n    ) {\n      setReplace(LIMIT_REPLACE_NODE, val, k, parent)\n      return\n    }\n\n    if (\n      typeof options.edgesLimit !== 'undefined' &&\n      edgeIndex + 1 > options.edgesLimit\n    ) {\n      setReplace(LIMIT_REPLACE_NODE, val, k, parent)\n      return\n    }\n\n    stack.push(val)\n    // Optimize for Arrays. Big arrays could kill the performance otherwise!\n    if (Array.isArray(val)) {\n      for (i = 0; i < val.length; i++) {\n        deterministicDecirc(val[i], i, i, stack, val, depth, options)\n      }\n    } else {\n      // Create a temporary object in the required way\n      var tmp = {}\n      var keys = Object.keys(val).sort(compareFunction)\n      for (i = 0; i < keys.length; i++) {\n        var key = keys[i]\n        deterministicDecirc(val[key], key, i, stack, val, depth, options)\n        tmp[key] = val[key]\n      }\n      if (typeof parent !== 'undefined') {\n        arr.push([parent, k, val])\n        parent[k] = tmp\n      } else {\n        return tmp\n      }\n    }\n    stack.pop()\n  }\n}\n\n// wraps replacer function to handle values we couldn't replace\n// and mark them as replaced value\nfunction replaceGetterValues (replacer) {\n  replacer =\n    typeof replacer !== 'undefined'\n      ? replacer\n      : function (k, v) {\n        return v\n      }\n  return function (key, val) {\n    if (replacerStack.length > 0) {\n      for (var i = 0; i < replacerStack.length; i++) {\n        var part = replacerStack[i]\n        if (part[1] === key && part[0] === val) {\n          val = part[2]\n          replacerStack.splice(i, 1)\n          break\n        }\n      }\n    }\n    return replacer.call(this, key, val)\n  }\n}\n",null,"// for backwards compat\nmodule.exports = require('json-rpc-engine/src/createScaffoldMiddleware')\n","const SafeEventEmitter = require('@metamask/safe-event-emitter').default\nconst createScaffoldMiddleware = require('eth-json-rpc-middleware/scaffold')\nconst { createAsyncMiddleware } = require('json-rpc-engine')\nconst createFilterMiddleware = require('./index.js')\nconst { unsafeRandomBytes, incrementHexInt } = require('./hexUtils.js')\nconst getBlocksForRange = require('./getBlocksForRange.js')\n\nmodule.exports = createSubscriptionMiddleware\n\n\nfunction createSubscriptionMiddleware({ blockTracker, provider }) {\n  // state and utilities for handling subscriptions\n  const subscriptions = {}\n  const filterManager = createFilterMiddleware({ blockTracker, provider })\n\n  // internal flag\n  let isDestroyed = false\n\n  // create subscriptionManager api object\n  const events = new SafeEventEmitter()\n  const middleware = createScaffoldMiddleware({\n    eth_subscribe: createAsyncMiddleware(subscribe),\n    eth_unsubscribe: createAsyncMiddleware(unsubscribe),\n  })\n  middleware.destroy = destroy\n  return { events, middleware }\n\n  async function subscribe(req, res) {\n\n    if (isDestroyed) throw new Error(\n      'SubscriptionManager - attempting to use after destroying'\n    )\n\n    const subscriptionType = req.params[0]\n    // subId is 16 byte hex string\n    const subId = unsafeRandomBytes(16)\n\n    // create sub\n    let sub\n    switch (subscriptionType) {\n      case 'newHeads':\n        sub = createSubNewHeads({ subId })\n        break\n      case 'logs':\n        const filterParams = req.params[1]\n        const filter = await filterManager.newLogFilter(filterParams)\n        sub = createSubFromFilter({ subId, filter })\n        break\n      default:\n        throw new Error(`SubscriptionManager - unsupported subscription type \"${subscriptionType}\"`)\n\n    }\n    subscriptions[subId] = sub\n\n    res.result = subId\n    return\n\n    function createSubNewHeads({ subId }) {\n      const sub = {\n        type: subscriptionType,\n        destroy: async () => {\n          blockTracker.removeListener('sync', sub.update)\n        },\n        update: async ({ oldBlock, newBlock }) => {\n          // for newHeads\n          const toBlock = newBlock\n          const fromBlock = incrementHexInt(oldBlock)\n          const rawBlocks = await getBlocksForRange({ provider, fromBlock, toBlock })\n          const results = rawBlocks.map(normalizeBlock)\n          results.forEach((value) => {\n            _emitSubscriptionResult(subId, value)\n          })\n        }\n      }\n      // check for subscription updates on new block\n      blockTracker.on('sync', sub.update)\n      return sub\n    }\n\n    function createSubFromFilter({ subId, filter }){\n      filter.on('update', result => _emitSubscriptionResult(subId, result))\n      const sub = {\n        type: subscriptionType,\n        destroy: async () => {\n          return await filterManager.uninstallFilter(filter.idHex)\n        },\n      }\n      return sub\n    }\n  }\n\n  async function unsubscribe(req, res) {\n\n    if (isDestroyed) throw new Error(\n      'SubscriptionManager - attempting to use after destroying'\n    )\n\n    const id = req.params[0]\n    const subscription = subscriptions[id]\n    // if missing, return \"false\" to indicate it was not removed\n    if (!subscription) {\n      res.result = false\n      return\n    }\n    // cleanup subscription\n    delete subscriptions[id]\n    await subscription.destroy()\n    res.result = true\n  }\n\n  function _emitSubscriptionResult(filterIdHex, value) {\n    events.emit('notification', {\n      jsonrpc: '2.0',\n      method: 'eth_subscription',\n      params: {\n        subscription: filterIdHex,\n        result: value,\n      },\n    })\n  }\n\n  function destroy () {\n    events.removeAllListeners()\n    for (const id in subscriptions) {\n      subscriptions[id].destroy()\n      delete subscriptions[id]\n    }\n    isDestroyed = true\n  }\n}\n\nfunction normalizeBlock(block) {\n  return {\n    hash: block.hash,\n    parentHash: block.parentHash,\n    sha3Uncles: block.sha3Uncles,\n    miner: block.miner,\n    stateRoot: block.stateRoot,\n    transactionsRoot: block.transactionsRoot,\n    receiptsRoot: block.receiptsRoot,\n    logsBloom: block.logsBloom,\n    difficulty: block.difficulty,\n    number: block.number,\n    gasLimit: block.gasLimit,\n    gasUsed: block.gasUsed,\n    nonce: block.nonce,\n    mixHash: block.mixHash,\n    timestamp: block.timestamp,\n    extraData: block.extraData,\n  }\n}\n","var arrayLikeToArray = require(\"./arrayLikeToArray.js\");\nfunction _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) return arrayLikeToArray(arr);\n}\nmodule.exports = _arrayWithoutHoles, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _iterableToArray(iter) {\n  if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter);\n}\nmodule.exports = _iterableToArray, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\nmodule.exports = _nonIterableSpread, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;"],"sourceRoot":""}